<?xml version='1.0' encoding='utf-8'?>
<?xml-model href="rfc7991bis.rnc"?>

<rfc
  xmlns:xi="http://www.w3.org/2001/XInclude"
  docName="draft-ietf-ccamp-optical-impairment-topology-yang-12"
  category="std"
  consensus="true"
  ipr="trust200902"
  submissionType="IETF">    
  
  <?rfc strict="yes"?>
  <?rfc compact="yes"?>
  <?rfc subcompact="no"?>
  <?rfc symrefs="yes"?>
  <?rfc sortrefs="no"?>
  <?rfc text-list-symbols="o*+-"?>
  <?rfc toc="yes"?>

  <front>
  <title abbrev="Opt. Impairment-Aware Topo YANG Model">
   A YANG Data Model for Optical Impairment-aware Topology</title>
  
  <author initials="D." surname="Beller" fullname="Dieter Beller" role="editor">
  <organization>Nokia</organization>
  <address><email>Dieter.Beller@nokia.com</email>
  </address>
  </author>
  
  <author initials="E." surname="Le Rouzic" fullname="Esther Le Rouzic">
  <organization>Orange</organization>
  <address><email>esther.lerouzic@orange.com</email>
  </address>
  </author>
  
  <author initials="S." surname="Belotti" fullname="Sergio Belotti">
  <organization>Nokia</organization>
  <address><email>Sergio.Belotti@nokia.com</email>
  </address>
  </author>

  <author initials="G." surname="Galimberti" fullname="G. Galimberti">
  <organization>Cisco</organization>
  <address><email>ggalimbe@cisco.com</email>
  </address>
  </author>
  
  <author initials="I." surname="Busi" fullname="Italo Busi">
  <organization>Huawei Technologies</organization>
  <address><email>Italo.Busi@huawei.com</email>
  </address>
  </author>
     
  <date year="2023" month="March" day="13" />
  <area>Routing</area>
  <workgroup>CCAMP Working Group</workgroup>

  <abstract>
  <t>
   In order to provision an optical connection through optical
   networks, a combination of path continuity, resource availability,
   and impairment constraints must be met to determine viable and
   optimal paths through the network. The determination of appropriate
   paths is known as Impairment-Aware Routing and Wavelength Assignment
   (IA-RWA) for WSON, while it is known as Impairment-Aware Routing and
   Spectrum Assignment (IA-RSA) for SSON.
  </t>

  <t>
   This document provides a YANG data model for the impairment-aware TE
   topology in optical networks.
  </t>

  </abstract>
  </front>

  <middle>
  <section title="Introduction" anchor="sect-1">
  <t>
   In order to provision an optical connection (an optical path)
   through a wavelength switched optical networks (WSONs) or spectrum
   switched optical networks (SSONs), a combination of path continuity,
   resource availability, and impairment constraints must be met to
   determine viable and optimal paths through the network. The
   determination of appropriate paths is known as Impairment-Aware
   Routing and Wavelength Assignment (IA-RWA) <xref target="RFC6566"/>
   for WSON, while it is known as IA-Routing and Spectrum Assigment
   (IA-RSA) for SSON.
  </t>

  <t>
   This document provides a YANG data model for the impairment-aware
   Traffic Engineering (TE) topology in WSONs and SSONs. The YANG model
   described in this document is a WSON/SSON technology-specific Yang
   model based on the information model developed in
   <xref target="RFC7446"/> and the two encoding documents
   <xref target="RFC7581"/> and <xref target="RFC7579"/> that developed
   protocol independent encodings based on <xref target="RFC7446"/>.
  </t>

  <t>
   The intent of this document is to provide a YANG data model, which
   can be utilized by a Multi-Domain Service Coordinator (MDSC) to
   collect states of WSON impairment data from the Transport PNCs to
   enable impairment-aware optical path computation according to the
   ACTN Architecture <xref target="RFC8453"/>. The communication
   between controllers is done via a NETCONF <xref target="RFC8341"/>
   or a RESTCONF <xref target="RFC8040"/>. Similarly,this model can
   also be exported by the MDSC to a Customer Network Controller (CNC),
   which can run an offline planning process to map latter the services
   in the network.
  </t>
  
  <t>
   It is worth noting that optical data plane interoperability is a
   complex topic especially in a multi vendor environment and usually
   requires joint engineering, which is independent from control plane
   and management plane capabilities. The YANG data model defined in
   this draft is providing sufficient information to enable optical
   impairment aware path computation.</t>
  <t> 
   Optical data plane interoperability is outside the scope of this
   draft.
  </t>

  <t>
   This document augments the generic TE topology YANG model defined
   in <xref target="RFC8795"/> where possible.
  </t>

  <t>
   This document defines one YANG module: ietf-optical-impairment-
   topology (<xref target="sect-3"/>) according to the new Network
   Management Datastore Architecture <xref target="RFC8342"/>.
  </t>

  <section title="Terminology" anchor="sect-1.1">
  <t>
   Refer to <xref target="RFC6566"/>, <xref target="RFC7698"/>, and
   <xref target="G.807"/> for the key terms used in
   this document.
  </t>

  <t>
   The following terms are defined in <xref target="RFC7950"/> and are
   not redefined here:
  </t>

  <t><list style="symbols"><?rfc subcompact="yes"?>
   <t>client</t>
   <t>server</t>
   <t>augment</t>
   <t>data model</t>
   <t>data node</t>
  <?rfc subcompact="no"?>
  </list></t>

  <t>
   The following terms are defined in <xref target="RFC6241"/> and are
   not redefined here:
  </t>

  <t><list style="symbols"><?rfc subcompact="yes"?>
   <t>configuration data</t>
   <t>state data</t>
  <?rfc subcompact="no"?>
  </list></t>

  <t>
   The terminology for describing YANG data models is found in
   <xref target="RFC7950"/>.
  </t>
  
  <t>
   The term ROADM in this document refers to the term "multi-degree
   reconfigurable optical add/drop multiplexer (MD-ROADM)" as defined
   in <xref target="G.672"/>.  It does not include local optical
   transponders, which can be co-located in the same physical device
   (managed entity).
  </t>
  
  <t>
   The term WDM-node refers to a physical device, which is managed as
   a single network element. 
  </t>
  
  <t>
   The term WDM-TE-node refers to those parts of a WDM-node (physical
   device) that are modeled as a TE-node as defined in
   <xref target="RFC8795"/>, which may include a ROADM and/or multiple
   local optical transponders(OTs). Hence, a WDM-TE-node may only
   contain OTs.
  </t>

  <t>
   The term "WDM-TE-network" refers to a set of WDM-TE-nodes as defined
   above that are interconnected via TE-links carrying WDM signals.
   These TE-links may include optical amplifiers.
  </t>

  <t>
   The term "add/drop TE-link" refers to a TE-link modeling the media
   channel between the optical port of a remote optical transponder
   (OT) and an add/drop port of the adjacent WDM-node. The add/drop
   TE-link typically carries a single OTSi signal (modulated optical
   carrier).
  </t>

  <t>
   The term "bundled add/drop TE-link" refers to the TE-link bundling
   concept as defined in <xref target="RFC8795"/>. Multiple component
   links, add/drop TE-links in this case, are bundled into a single
   bundled add/drop TE-Link.
  </t>

  </section>

  <section title="Tree Diagram" anchor="sect-1.2">
  <t>
   A simplified graphical representation of the data model is used in
   Section 2 of this this document.  The meaning of the symbols in
   these diagrams is defined in <xref target="RFC8340"/>.
  </t>

  </section>

  <section title="Prefixes in Data Node Names" anchor="sect-1.3">
  <t>
   In this document, names of data nodes and other data model objects
   are prefixed using the standard prefix associated with the
   corresponding YANG imported modules, as shown in
   <xref target="tab-prefixes-and-corresponding-yang-modules"/>.
  </t>

  <texttable title="Prefixes and corresponding YANG modules"
   anchor="tab-prefixes-and-corresponding-yang-modules" style="full">
   <ttcol> Prefix</ttcol>
   <ttcol> YANG module</ttcol>
   <ttcol> Reference</ttcol>
   <c>optical-imp-topo</c>
   <c>ietf-optical-impairment-topology</c>
   <c>[RFCXXXX]</c>
   <c>layer0-types</c>
   <c>ietf-layer0-types</c>
   <c><xref target="RFC9093"/></c> 
   <c>l0-types-ext</c>
   <c>ietf-layer0-types-ext</c>
   <c><xref target="I-D.ietf-ccamp-rfc9093-bis"/></c>
   <c>nw</c>
   <c>ietf-network</c>
   <c><xref target="RFC8345"/></c>
   <c>nt</c>
   <c>ietf-network-topology</c>
   <c><xref target="RFC8345"/></c>
   <c>tet</c>
   <c>ietf-te-topology</c>
   <c><xref target="RFC8795"/></c>
  </texttable>
  
  <t>
   [Editor's note: The RFC Editor will replace XXXX with the number assigned to
   the RFC once this draft becomes an RFC.]
  </t>

  </section>

  </section>

  <section title="Reference Architecture" anchor="sect-2">
  <section title="Control Plane Architecture" anchor="sect-2.1">
  <t>
   <xref target="Figure-1"/> shows the control plane architecture.
  </t>

  
  <figure align="center" title="Scope of draft-ietf-ccamp-dwdm-if-param-yang" anchor="Figure-1">
  <artwork><![CDATA[
                          +--------+
                          |  MDSC  |
                          +--------+
 Scope of this ID  ------->   ||
               |              ||
               |  +------------------------+
               |  |        OPTICAL         |
  +---------+  |  |         DOMAIN         |     +---------+
  | Device  |  |  |       CONTROLLER       |     | Device  |
  | config. |  |  +------------------------+     | config. |
  +---------+  v  //          ||          \\     +---------+
 ______|______   //           ||           \\   ______|______
/      OT     \ //            ||            \\ /      OT     \
| +--------+  |//           __--__           \\|  +--------+ |
| |Vend. A |--|----+       (      )       +----|--| Vend. A| |
| +--------+  |    |    ~-(        )-~    |    |  +--------+ |
| +--------+  |    +---/              \---+    |  +--------+ |
| |Vend. B |--|--+    /                \    +--|--| Vend. B| |
| +--------+  |  +---(   OLS Segment    )---+  |  +--------+ |
| +--------+  |  +---(                  )---+  |  +--------+ |
| |Vend. C |--|--+    \                /    +--|--| Vend. C| |
| +--------+  |    +---\              /---+    |  +--------+ |
| +--------+  |    |    ~-(        )-~    |    |  +--------+ |
| |Vend. D |--|----+       (__  __)       +----|--| Vend. D| |
| +--------+  |               --               |  +--------+ |
\_____________/                                \_____________/
          ^                                        ^
          |                                        |
          |                                        |
         Scope of [I-D.ietf-ccamp-dwdm-if-param-yang]

]]></artwork>
  </figure>
  
  <t>
   The topology model developed in this document is an abstracted
   topology YANG model that can be used at the interfaces between the
   MDSC and the Optical Domain Controller (aka MPI) and between the
   Optical Domain Controller and the Optical Device (aka SBI) in
   <xref target="Figure-1"/>.
   It is not intended to support a detailed low-level DWDM interface
   model. DWDM interface model is supported by the models presented in
   <xref target="I-D.ietf-ccamp-dwdm-if-param-yang"/>.
  </t>
  
  </section>

  <section title="Optical Transport Network Data Plane" anchor="sect-2.2">
 
  <t>
   This section provides the description of the optical transport
   network reference architecture and its relevant components to
   support optical impairment-aware path computation.
  </t>

  <t>
   <xref target="Figure-2"/> shows the reference architecture.
  </t>

  <figure title="Reference Architecture for Optical Transport Network"
   anchor="Figure-2"><artwork><![CDATA[
  +-------------------+                      +-------------------+
  |     WDM-Node 1    |                      |     WDM-Node 2    |
  |                   |                      |                   |
  | PA  +-------+ BA  |         ILA          | PA  +-------+ BA  |
  | +-+ |       | +-+ |  _____  +--+  _____  | +-+ |       | +-+ |
--|-| |-| ROADM |-| |-|-()____)-|  |-()____)-|-| |-| ROADM |-| |-|--
  | +-+ |       | +-+ |         +--+         | +-+ |       | +-+ |
  |     +-------+     | optical              |     +-------+     |
  |       | | |       |  fiber               |       | | |       |
  |       o o o       |                      |       o o o       |
  |    local          |                      |    local          |
  |    transponders   |                      |    transponders   |
  +-------------------+                      +-------------------+
                      
                       OTS MCG        OTS MCG
                     <--------->    <--------->
                         OMS MCG = TE-link
                 <-------------------------------->

   BA: Booster Amplifier (or egress amplifier)
   PA: Pre-Amplifier (or ingress amplifier)
   ILA: In-Line Amplifier
   MCG: Media Channel Group
]]></artwork>
  </figure>

  <t>
   BA (WDM-node 1) is the egress Amplifier and PA (WDM-node 2) is the
   ingress amplifier for the OMS Media Channel Group (MCG) in the
   direction from left to right in <xref target="Figure-2"/>.
  </t>
  
  <t>
   According to <xref target="G.807"/>, a Media Channel Group (MCG)
   represents "a unidirectional point-to-point management/control
   abstraction that represents a set of one or more media channels that
   are co-routed. A media channel group (MCG) is bounded by a pair of
   media ports." 
  </t>
  
  </section>

  <section title="OTS and OMS Media Channel Group" anchor="sect-2.3">
   
  <t>
   According to <xref target="G.807"/>, an
   OTS Media Channel Group (MCG) represents a topological construct
   between two adjacent amplifiers, such as:
  </t>
  
  <figure>
  <artwork><![CDATA[
  (i)  between a WDM-TE-node's BA and the adjacent ILA,
 (ii)  between a pair of ILAs,
(iii)  between an ILA and the adjacent WDM-TE-node's PA.
]]></artwork>
  </figure>
  
  <t>
   <xref target="G.807"/> defines an OMS MCG as "The topological
   relationship between the media port on a filter or coupler where a
   set of media channels are aggregated and the media port on a filter
   or coupler where one or more media channel is added to or removed 
   from that aggregate. All of the media channels that are represented
   by the OMS MCG must be carried over the same serial concatenation of
   OTS MCGs and amplifiers."
  </t>
  
  <t>
   An OMS MCG originates at the ROADM in the source WDM-node and
   terminates at the ROADM in the destination WDM-node traversing the
   Booster Amplifier (BA) and the Pre-Amplifier (PA) in the WDM-nodes
   as well as the In-Line Amplifiers (ILAs) between the two WDM-nodes.
  </t>
  
  <t>
   An OMS MCG can be decomposed into a sequence of OTS MCGs and
   amplifiers.
  </t>
  
  <t>
   An OMS MCG traverses a sequence of elements such as BA, fiber
   section, ILA, PA, and concentrated loss wherever there is an
   insertion loss caused for example by a fiber connector.
  </t>

  <t>
   In TE-topology terms, the OMS MCG is modeled as a WDM TE-link
   interconnecting two WDM-TE-nodes. A network controller can retrieve
   the optical impairment data for all the WDM TE-link elements defined
   in the layer-0 topology YANG model.
  </t>

  <t>
   The optical impairments related to the link between remote optical
   transponders, located in a different WDM-TE-node (an IP router with
   integrated optical transponders for example), can also be modeled
   as a WDM TE-link using the same optical impairments as those defined
   for a WDM TE-link between WDM-TE-nodes (OMS MCG). In this scenario,
   the node containing the remote optical transponders can be
   considered as WDM-TE-node with termination capability only and no
   switching capabilities.
  </t>
  
  <t>
   A WDM TE-link is terminated on both ends by a link termination point
   (LTP) as defined in <xref target="RFC8795"/>.
   Links between WDM nodes in optical transport networks are typically
   bidirectional.
   Generally, they have different impairments in the two directions and
   hence they have to be modeled as a pair of two unidirectional
   TE-links following the  <xref target="RFC8795"/> modeling approach.
   Unlike TE-links, which are unidirectional, the LTPs on either end
   of the TE-link pair forming the bidirectional link, are bidirectional
   as described in
   <xref target="I-D.ietf-teas-te-topo-and-tunnel-modeling"/> and the
   pair of unidirectional links are connected to the same bidirectional
   LTP on either end of the link pair.
  </t>

 <section title="Optical Tributary Signal (OTSi)" anchor="OTSi">
  <t>
   The OTSi is defined in ITU-T Recommendation G.959.1, section 3.2.4
   <xref target="G.959.1"/> as "Optical signal that is placed within a 
   network media channel for transport across the optical network. This
   may consist of a single modulated optical carrier or a group of
   modulated optical carriers or subcarriers."
   
   The YANG model defined below assumes that
   a single OTSi consists of a single modulated optical carrier. This
   single modulated optical carrier conveys digital information.
   Characteristics of the OTSi signal are modulation scheme (e.g. QPSK,
   8-QAM, 16-QAM, etc.), baud rate (measure of the symbol rate), pulse
   shaping (e.g. raised cosine - complying with the Nyquist inter
   symbol interference criterion), etc.
  </t>
  
  <t>
   Path computation needs to know the existing OTSi signals for each
   OMS link in the topology to determine the optical impairment impact
   of the existing OTSi signals on the optical feasibility of a new
   OTSi signal and vice versa, i.e., the impact of the new OTSi on the
   existing OTSi signals. For determining the optical feasibility of
   the new OTSi, it is necessary to know the OTSi properties like
   carrier frequency, baud rate, and signal power for all existing
   OTSi signals on each OMS link.
  </t> 
  
  <t>  
   Additionally, it is necessary for each WDM-TE-node in the network to
   know the OTSi signals that are added to or dropped from an WDM
   TE-link (OMS MCG)link as well as the optical power of these OTSi
   signals to check whether the WDM-TE-node's optical power constraints
   are met.
  </t>

  <t>
   The optical impairment-aware topology YANG model below defines the
   OTSi properties needed for optical impairment-aware path computation
   including the spectrum occupied by each OTSi signal. The model also
   defines a pointer (leafref) from the OTSi to the transceiver module
   terminating the OTSi signal.   
  </t>
  
  <t>
   The OTSi signals in the YANG model are described by augmenting the
   network and each OTSi signal is uniquely identified by its
   otsi-carrier-id, which is unique within the scope the OTSiG [see
   <xref target="OTSiG" /> below] the OTSi belongs to.
  </t>

  </section>

  <section title="Optical Tributary Signal Group (OTSiG)" anchor="OTSiG">
  <t>
   The OTSiG is defined in ITU-T Recommendation G.807 <xref target="G.807"/>
   as a "set of optical tributary signals (OTSi) that supports a single
   digital client".
   Hence, the OTSiG is an electrical signal that is carried by one or more
   OTSi's. The relationship between the OTSiG and the the OTSi's is
   described in <xref target="G.807"/>, section 10.2.
   The YANG model below supports both cases: the single OTSi case
   where the OTSiG contains a single OTSi (see <xref target="G.807"/>,
   Figure 10-2) and the multiple OTSi case where the OTSiG consists of more
   than one OTSi (see <xref target="G.807"/>, Figure 10-3).
   From a layer 0 topology YANG model perspective, the OTSiG is a logical
   construct that associates the OTSi's, which belong to the same OTSiG.
   The typical application of an OTSiG consisting of more than one OTSi is
   inverse multiplexing. Constraints exist for the OTSi's belonging to the
   same OTSiG such as: (i) all OTSi's must be co-routed over the same
   optical fibers and nodes and (ii) the differential delay between the
   different OTSi's may not exceed a certain limit. Example: a 400Gbps
   client signal may be carried by 4 OTSi's where each OTSi carries
   100Gbps of client traffic.
  </t>
  
  <t>
   All OTSiGs are described in the YANG model by augmenting the network
   and each OTSiG is uniquely identified by its otsi-group-id, which is
   unique within the network. Each OTSiG also contains a list of the
   OTSi signals belonging to the OTSiG.
  </t>

  <figure align="center" title="MC Example containing all 4 OTSi signals of an OTSiG"
   anchor="Figure-3"><artwork><![CDATA[
                               OTSiG
        _________________________/\__________________________
       /                                                     \
                                 m=7
- - - +---------------------------X---------------------------+ - - -
/ / / |                                                       | / / /
 / / /|      OTSi         OTSi         OTSi         OTSi      |/ / /
/ / / |        ^            ^            ^            ^       | / / /
 / / /|        |            |            |            |       |/ / /
/ / / |        |            |            |            |       | / / /
 / / /|        |            |            |            |       |/ / /
 -4  -3  -2  -1   0   1   2   3   4   5   6   7   8   9  10  11  12
--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---
                                n = 4
               K1           K2           K3           K4
]]></artwork>
  </figure>

  </section>
  
  <section title="Media Channel (MC)" anchor="MC">
    
  <t>
   <xref target="G.807"/> defines a "media channel" as "A media
   association that represents both the topology (i.e., the path
   through the media) and the resource (i.e., frequency slot or
   effective frequency slot) that it occupies." In this document,
   the term "channel" is occasionally used to indicate the resource
   of an MC (i.e., frequency slot or effective frequency slot),
   without representing topology.
  </t>
  
  <t>
   In this document, an end-to-end MC is defined as a type of MC,
   which is formed by the serial concatenation of all the MCs from
   source Transceiver media ports to destination transceiver media
   ports.
   This end-to-end MC is defined across all the ROADM nodes along the
   end-to-end optical path with the same nominal central frequency n
   and frequency slot of width m, which represents the effective
   frequency slot of the end-to-end MC.
   An end-to-end MC can carry a single OTSi, or multiple OTSi signals
   belonging to the same OTSiG.
  </t>

  <t>
   <xref target="G.807 Amd1"/> defines a "network media channel (NMC)"
   as "a type of media channel that is formed by the serial
   concatenation of all media channels between the media port of a
   modulator and the media port of a demodulator". The modulator and
   demodulator are integral functions of a transceiver and their media
   ports do not necessarily coincide with the media port of the 
   transceiver, which is associated with the transceiver's physical
   optical port. Due to this difference, the end-to-end MC is defined
   above and is used in this document.
  </t>

  <figure align="center" title="Figure Caption TBA" anchor="Figure-4">
   <artwork><![CDATA[
                                 m=8
  +-------------------------------X-------------------------------+
  |                               |                               |
  |     +----------X----------+   |   +----------X----------+     |
  |     |        OTSi         |       |        OTSi         |     |
  |     |          ^          |   |   |          ^          |     |
  |     |          |          |       |          |          |     |
 -4  -3  -2  -1   0   1   2   3   4   5   6   7   8   9  10  11  12
--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+-
                   |             n=4             |
                   K1                            K2

  <------------------------ Media Channel ----------------------->
]]></artwork>
  </figure>
  
  <t>
   The frequency slot of the MC is defined by the n value defining the
   central frequency of the MC and the m value that defines the width
   of the MC following the flexible grid definition in
   <xref target="G.694.1"/>. In this model, the effective frequency
   slot as defined in <xref target="G.807"/> is equal to the frequency
   slot of this MC. It is also assumed that ROADM devices
   can switch MCs.
   For various reasons (e.g. differential delay), it is preferred to
   use a single MC for all OTSi's of the same OTSiG. It may however not
   always be possible to find a single MC for carrying all OTSi's of an
   OTSiG due to spectrum occupation along the OTSiG path.
  </t>

  </section>

  <section title="Media Channel Group (MCG)" anchor="sect-2.3.4">
  <t>
   ITU-T [G.807] defines the Media Channel Group MCG as
   "A unidirectional point to point management/control abstraction 
   that represents a set of one or more media channels that are 
   co-routed."
   The YANG model below assumes
   that the MCG is a logical grouping of one or more MCs that are used
   to to carry all OTSi's belonging to the same OTSiG.
  </t>

  <t>
   The MCG can be considered as an association of MCs without defining
   a hierarchy where each MC is defined by its (n,m) value pair. An MCG
   consists of more than one MC when no single MC can be found from
   source to destination that is wide enough to accommodate all OTSi's
   (modulated carriers) that belong to the same OTSiG. In such a case
   the set of OTSi's belonging to a single OTSiG have to be split
   across 2 or more MCs.
  </t>

  <figure align="center" title="Figure Caption TBA" anchor="Figure-5"><artwork><![CDATA[
                                MCG1 = {M1.1, M1.2}
       __________________________/\________________________
      /                                                    \
                  M1.1                  M2          M1.2
       ____________/\____________  _____/\_____  ____/\____
      /                          \/            \/          \
- - - +---------------------------+-------------+-----------+ - - -
/ / / |                           | / / / / / / |           | / / /
 / / /|    OTSi    OTSi    OTSi   |/ / / / / / /|    OTSi   |/ / /
/ / / |     ^       ^       ^     | / / / / / / |     ^     | / / /
 / / /|     |       |       |     |/ / / / / / /|     |     |/ / /
/ / / |     |       |       |     | / / / / / / |     |     | / / /
 / / /|     |       |       |     |/ / / / / / /|     |     |/ / /
     -7    -4    -1 0 1 2 3 4 5 6 7 8    ...    14    17    20
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    n=0                               n=17
            K1      K2      K3                        K4
]]></artwork>
  </figure>
  
  <t>
   The MCG is relevant for path computation because all end-to-end MCs
   belonging to the same MCG have to be co-routed, i.e., have to follow
   the same path. Additional constraints may exist (e.g. differential
   delay).
  </t>
  
  </section>

  </section>

  <section title="Amplifiers" anchor="sect-2.4">
  <t>
   Optical amplifiers are used in WDM networks for amplifying the
   optical signal in the optical domain without any optical to
   electrical and electrical to optical conversion. There are three
   main optical amplifier technologies:
  </t>

  <t>
    <list style="symbols"><?rfc subcompact="yes"?>
      <t>Erbium Doped Fiber Amplifiers (EDFAs)</t>
      <t>Raman Amplifiers</t>
      <t>Semiconductor Optical Amplifiers (SOAs)</t>
    <?rfc subcompact="no"?>
    </list>
  </t>

  <t> 
   In today's WDM networks EDFAs and Raman amplifiers are widely used.
   Raman amplifiers have become attractive due to their large spectral
   gain bandwidth, which can be quite flat, with similar or even lower
   noise figures compared to EDFAs. On the other hand, Raman amplifiers
   consume more power and are usually more expensive than EDFAs.
  </t>
  
  <t>
   Raman amplifiers are distributed amplifiers where an optical pump
   signal is injected typically in opposite direction to the optical
   signal that is amplified (backward pump, counter-propagating pump
   light). Injecting the optical pump signal in the same direction is
   also possible (forward pump, co-propagating pump light).
   For optical amplifiers, the YANG model defines Raman pump light
   attributes describing the direction (raman-direction) with respect
   to the signal that is amplified and optical frequency and power for
   the pump light source(s) contained in the raman-pump list. These   
   Raman amplifier-specific attributes are optional as they are only
   applicable to Raman amplifiers. For determining the optical amplifier
   type, i.e., to figure out whether an optical amplifier is a Raman
   amplifier, the type-variety attribute is used.
   Due to the distributed nature of the Raman amplifier it is difficult
   to clearly separate the amplifier from the fiber span into which the
   pump signal is injected. From a topology modeling perspective, the
   Raman amplifier is modeled as two OMS line elements:
  </t>
  
  <t>
    <list style="numbers"><?rfc subcompact="yes"?>
      <t>
       a passive fiber element accounting for the fiber loss only
       and not the resulting loss including the Raman gain</t>
      <t>
       an amplifier element providing all optical amplifier properties
       (gain, tilt, etc.). On the OMS-link, the amplifier element is
       placed where the pump is located and the geolocation information
       also indicates the location of the pump.
      </t>
    <?rfc subcompact="no"?>
    </list>
  </t>
  
  <t>
   Amplifiers can be classified according to their location along the
   TE-link (OMS MCG). There are three basic amplifier types: In-Line
   Amplifiers, Pre-Amplifiers and Booster Amplifiers. ILAs are separate
   physical devices while Pre-Amplifiers and Booster Amplifiers are
   integral elements of a WDM-node. From a data modeling perspective,
   node-internal details should not be modeled and should be abstracted
   as much as possible. For Pre-Amplifiers and Booster Amplifiers,
   however, a different approach has been taken and they are modeled as
   TE-link elements as they have the same optical impairments as ILAs.
  </t>
  
  <t>
   ILAs are placed at locations where the optical amplification of the
   WDM signal is required on the TE-link (OMS MCG) between two
   WDM-TE-nodes nodes.
   Geolocation information is already defined for TE nodes in
   <xref target="RFC8795"/> and is also beneficial for ILAs. Therefore,
   the same geolocation container has been added to the amplifier
   element on an OMS link containing altitude, latitude, and longitude
   as optional attributes.
  </t>
  
  <t>
   One modeling consideration of the ROADM internal is to model power
   parameter through the ROADM, factoring the output power from the
   Pre-Amplifier minus the ROADM power loss would give the input power
   to the Booster Amplifier. In other words, Power_in (@ ROADM Booster)
   = Power_out (@ ROADM Pre-Amplifier) - Power_loss (@ ROADM
   WSS/Filter).
  </t>

  </section>

  <section title="Transponders" anchor="sect-2.5">
  <t>
   [Editor's note: The relationship between the transponder and the
   OTSi in the YANG model described in <xref target="sect-3"></xref>
   needs further clarification and refinement.]
  </t>

  <t>
   A Transponder is the element that sends and receives the optical
   signal from a DWDM network. A transponder can comprise one or more
   transceivers. A transceiver represents a transmitter/receiver
   (Tx/Rx) pair as defined in ITU-T Recommendation G.698.2
   <xref target="G.698.2"/>. In addition to the transceiver, which is
   terminating an OTSi signal, a transponder typically provides
   additional layer 1 functionality like for example aggregation
   (multiplexing) of client layer signals, which is outside the scope
   of this document addressing layer 0 aspects of transponders.
  </t>
  
  <t>
   The termination of an OTSi signal by a transceiver is modeled as a
   function of the tunnel termination point (TTP) as defined in
   <xref target="RFC8795"/>.
   Due to the fact that optical transport services (TE tunnels) are
   typically bidirectional, a TTP is also modeled as a bidirectional
   entity like the LTP described above. Moreover, a TTP can terminate
   one or several OTSiG signals (tunnels) as described in
   <xref target="I-D.ietf-teas-te-topo-and-tunnel-modeling"/> and each
   OTSiG consists of one or multiple OTSi signals as described in
   <xref target="OTSiG"/>.
   Therefore, a TTP may be associated with multiple transceivers.
  </t>
  
  <t>
   A transponder is typically characterized by its data/symbol rate
   and the maximum distance the signal can travel. Other transponder
   properties are: carrier frequency for the optical channels,
   output power per channel, measured input power, modulation scheme,
   FEC, etc.
  </t>

  <t>
   From a path computation perspective, the selection of the compatible
   configuration of the source and the destination transceivers is an
   important factor for optical signals to traverse through the DWDM
   network.
  </t>
  
  <!--<t>
   A Transponder is the element that sends and receives the optical
   signal from a fiber. A transponder is typically characterized by its
   data rate and the maximum distance the signal can travel. Channel
   frequency, per channel input power, FEC and Modulation are also
   associated with a transponder. From a path computation point of
   view, the selection of the compatible source and destination
   transponders is an important factor for optical signal to traverse
   through the fiber. There are three main approaches to determine
   optical signal compatibility. Application Code based on G.698.2
   <xref target="G.698.2"/> is one approach that only checks the code
   at both ends of the link. Another approach is organization codes
   that are specific to an organization or a vendor. The third approach
   is specify all the relevant parameters explicitly, e.g., FEC type,
   Modulation type, etc.
  </t>-->
  
  <t>
   The YANG model defines three different approaches to describe the
   transceiver capabilities (called "modes") that are needed to
   determine optical signal compatibility:
  </t>
  
  <t>
    <list style="symbols"><?rfc subcompact="yes"?>
      <t>Standard Modes</t>
      <t>Organizational Modes</t>
      <t>Explicit Modes</t>
    <?rfc subcompact="no"?>
    </list></t>


  <section title="Standard Modes" anchor="sect-2.5.1">
  <t>
   A standard mode is related to an optical specification developed
   by an SDO organization. Currently, the "Standard Modes" can only
   be referred to ITU-T G.698.2 <xref target="G.698.2"/> since G.698.2
   is the only specification defining "Standard Modes" today.
   Nothing is precluding, however, to consider other specifications
   provided by any other SDO in the Standard Mode context as soon as
   such sepcifications will be available. An application code as
   defined in ITU-T G.698.2 <xref target="G.698.2"/> is representing
   a standard ITU-T G.698.2 optical interface specification towards
   the realization of transversely compatible DWDM systems.
   Two transceivers supporting the same application code and a line
   system matching the constraints, defined in ITU-T G.698.2, for that
   application code will interoperate. As the characteristics are
   encoded in the application code, the YANG model in this document
   only defines a string, which represents that application code.
  </t>
  
  </section>
  
  <section title="Organizational Modes" anchor="sect-2.5.2">
  <t>
   Organizations like operator groups, industry fora, or equipment
   vendors can define their own optical interface specifications and
   make use of transceiver capabilities going beyond existing standards. 
  </t>
  
  <t>
   An organizational mode is identified by the organization-identifier
   attribute defining the scope and an operational-mode that is meaningful
   within the scope of the organization. Hence, the two attributes must
   always be considered together. It is the responsibility of the
   organization to assign operational modes and to ensure that operational
   modes are unique and unambiguous within the scope of the organization.
  </t>
  
  <t>
   Two transceivers can be interconnected, if they have at least one
   (organization-identifier, operational-mode) pair in common and if the
   supported carrier frequency and power attributes have a matching range.
   This is a necessary condition for path computation in the context of
   organizational modes.
  </t>
  
  <t>
   An operational mode is a transceiver preset (a configuration with
   well-defined parameter values) subsuming several transceiver properties
   defined by the optical interface specification - these properties are
   not provided for an operational mode and are therefore not defined in the
   YANG model. Examples of these properties are:
  </t>

  <t><list style="symbols"><?rfc subcompact="yes"?>
    <t>FEC type</t>
    <t>Modulation scheme</t>
    <t>Encoding (mapping of bit patterns (code words) to symbols in the
       constellation diagram)</t>
    <t>Baud rate (symbol rate)</t>
    <t>Carrier bandwidth (typically measured in GHz)</t>
    <?rfc subcompact="no"?>
  </list></t>
  
  <t>
   The major reason for these transceiver presets is the fact that the
   attribute values typically cannot be configured independently and
   are therefore advertised as supported operational mode capabilities.
   It is the responsibility of the organization to assign operational
   modes and to ensure that operational modes are unique and not
   ambiguous within the scope of the organization.
  </t>

  <t>
   In addition to the transceiver properties subsumed by the
   operational mode, optical power and carrier frequency related
   properties are modeled separately, i.e., outside of the operational
   mode. This modeling approach allows transponders using different
   transceiver variants (e.g. optical modules) with slightly different
   power and/or frequency range properties to interoperate without
   defining separate operational modes. Different optical modules
   (pluggables) from different suppliers typically have slightly
   different input and output power ranges or may have slightly
   different carrier frequency tuning ranges.
  </t>
  
  <t>
   The received channel power and the received total power are two
   parameters that can be measured by the receiver and can be provided
   by the transceiver in order to allow a controller to determine the
   expected performance of the end-to-end service taking into account
   the optical impairments along the path.
  </t>
  
  <t>
   An organization may define the operational modes to include the
   optical power and carrier frequency related properties following the
   application code approach as defined in ITU-T Recommendation G.698.2
   <xref target="G.698.2"/>. In such a case, the explicit optical power
   and carrier frequency related optional attributes shall be omitted
   in order to avoid redundant information in the description of the
   transceiver capabilities. If these attributes are provided in
   addition to the operational modes including these attribute values
   implicitly, the parameter values provided explicitly replace the
   implicit values and take precedence. This shall, however, only be
   an done in exceptional cases and shall be avoided whenever possible.
   In case an implicitly given range is extended utilizing the explicit
   optional attributes, a path computation policy rule may be applied
   to select a value preferably from the range defined implicitly and
   to only select a value from the extended range if no path can be
   found for values in the implicitly defined range. Path computation
   policy is outside the scope of this topology YANG model.
  </t>
  
  <t>
   In summary, the optical power and carrier frequency related
   attributes shall either be described implicitly by the operational
   mode following the definition provided by that organization or shall
   be described explicitly when the optical power and carrier frequency
   related properties are not included in the operational mode
   definition.
  </t>
  </section>

  <section title="Explicit Modes" anchor="sect-2.5.3">
  <t>
   The explicit mode allows to encode, explicitly, any subset of
   parameters e.g., FEC type, Modulation type, etc, to enable a
   controller entity to check for interoperability by means outside
   of this draft. It shall be noted that using the explicit encoding
   does not guarantee interoperability between two transceivers even
   in case of identical parameter definitions. The explicit mode
   shall therefore be used with care, but it could be useful when no
   common Application Codes or Organizational Modes exist or the
   constraints of common Application Codes or Organizational Modes
   cannot be met by the line system.
  </t>
  
  </section>

  <section title="Transponder Capabilities and Current Configuration" anchor="sect-2.5.4">
  <t>
   The YANG model described in <xref target="sect-3"/> defines the
   optical transceiver properties. They are divided between:
  </t>

  <t><list style="letters"><?rfc subcompact="yes"?>
   <t>Optical transceiver capabilities, describing how it can be configured</t>
   <t>Current transceiver setting, indicating how it is currently configured</t>
  <?rfc subcompact="no"?>
  </list></t>
  
  <t>
   The transceiver capabilities are described by the set of modes the
   transceiver is supporting. Each mode MUST follow only one of the
   three mode options defined above (choice in the YANG model). The
   YANG model allows to describe the transceiver capabilities by mixing
   different modes. A transceiver may support some ITU-T application
   codes and in addition some organizational or explicit modes.
  </t>
  
  <t>
   A transceiver mode description comprises the following properties:
  </t>
  
  <t><list style="symbols"><?rfc subcompact="yes"?>
   <t>Supported transmitter tuning range with min/max nominal carrier
      frequency [f_tx_min, f_tx_max]</t>
   <t>Supported transmitter tunability describing the transmitter's
      frequency fine tuning steps (the minimum distance between two
      adjacent carrier frequencies in GHz)</t>
   <t>Supported transmitter power range [p_tx-min, p_tx_max]</t>
   <t>Supported receiver channel power range [p_rx-min, p_rx_max]</t>
   <t>Supported maximum total power, rx power for all channels fed
      into the receiver</t>
  <?rfc subcompact="no"?>
  </list></t>
  
  <t>
   These optical transceiver properties are explicitly defined in the
   model for explicit and organizational modes, while they are
   implicitly defined for the application codes (see ITU-T G698.2
   <xref target="G.698.2"/>).
  </t>
  
  <t>
   The set of optical impairment limits, e.g., min OSNR, max PMD,
   max CD, max PDL, Q-factor limit, are explicitly defined for the
   explicit modes while they are  defined implicitly for the
   application codes and organizational modes.
  </t>
  
  <t>
   It is possible that the set of parameter values defined for an
   explicit mode may also be represented in form of an organizational
   mode or one or more application codes. The "supported-mode"
   container may provide two different lists with pointers to
   application codes and organizational modes, respectively.
  </t>
  
  <t>
   The current transponder configuration describes the properties of
   the OTSi transmitted or received by the transceiver attached to a
   specific transponder port.
  </t>
  
  <t>
   Each OTSi has the following three pointer attributes modeled as
   leafrefs:
  </t>
  
  <t><list style="symbols"><?rfc subcompact="yes"?>
  <t>Pointer to the transponder instance containing the transceiver
     terminating the OTSi</t>
  <t>Pointer to the transceiver instance terminating the OTSi</t>
  <t>Pointer to the currently configured transceiver mode</t>
  <?rfc subcompact="no"?>
  </list></t>
  
  <t>
   Additionally, the OTSi is described by the following frequency and
   optical power related attributes:
  </t>
  
  <t><list style="symbols"><?rfc subcompact="yes"?>
  <t>current carrier-frequency</t>
  <t>currently transmitted channel power</t>
  <t>currently received channel power</t>
  <t>currently received total power</t>
  <?rfc subcompact="no"?>
  </list></t>

  </section>
  
  </section>
  
  
  <section title="3R Regenerators" anchor="sect-2.6">
  
  <t>
   Optical transponders are usually used to terminate a layer 0 tunnel (layer 0
   service) in the WDM layer. If, however, no optical path can be found from
   the source transponder to the destination transponder that is optically
   feasible due to the optical impairments, one or more 3R regenerators are
   needed for regenerating the optical signal in intermediate nodes.
   The term "3R" regenerator means: reamplification, reshaping, retiming.
   As described in <xref target="G.807"/>, Appendix IV, a 3R regenerator
   terminates the OTSi and generates a new OTSi. Depending on the 3R
   regenerator capabilities, it can provide functions such as carrier frequency
   translation (carrier-frequency), changes in the modulation scheme
   (modulation-type) and FEC (FEC-type) while passing through the digital
   signal except the FEC (the FEC is processed and errors are corrected).
  </t>

  <t>
   The 3R regeneration compound function is illustrated in section 10.1
   of <xref target="G.798.1"/>, and sections 10.3 and 10.4 provide
   examples of a ROADM architecture and a photonic cross-connect
   architecture including 3R regenerators.
   Based on the provided functionality, 3R regenerators are considered
   as topological layer 0 entities because they are needed for layer 0
   path computation in case the optical impairments make it impossible
   to find an optically feasible end-to-end path from the source
   transponder to the destination transponder without 3R regeneration.
   When an end-to-end path includes one or more 3R regenerators, the
   corresponding layer 0 tunnel is subdivided into 2 or more segments
   between the source transponder and the destination transponder
   terminating the layer 0 tunnel.
  </t>
  
  <t>
   3R regenerators are usually realized by a pair of optical transponders,
   which are described in <xref target="sect-2.5"/> above. If a pair of optical
   transponders is used to perform a 3R regeneratator function, two different
   configurations are possible involving the pair of optical transceivers of
   the two optical transponders:
  </t>

  <t><list style="symbols">
   <t>
    The two transponders can be operated in a back-to-back configuration where
    the transceiver of each optical transponder receives and transmits the
    optical signal from/to the same segment of the end-to-end tunnel. This means
    that each transceiver is operated in a bi-directional mode.
   </t>
  </list></t> 
  
  <figure align="center" title="Back-to-back 3R Regenerator Example" anchor="Figure-x">
   <artwork><![CDATA[

          Optical Transponder 1        Optical Transponder 2
        +-----------------------+    +-----------------------+
        | Transceiver           |    |           Transceiver |
        |-------------+   +-----|    |-----+   +-------------|
    --->| Receiver    |---|Sig. |--->|Sig. |---| Transmitter |--->
        |-------------+   |     |    |     |   +-------------|
    <---| Transmitter |---|Proc.|<---|Proc.|---|    Receiver |<---
        |-------------+   +-----|    |-----+   +-------------|
        |                       |    |                       |
        +-----------------------+    +-----------------------+

        Sig. Proc. = Signal Processing

]]></artwork>
  </figure>
  
  <t><list style="symbols">
   <t>
    The two transponders can be operated in a configuration where each
    transponder performs the 3R regeneration function in one direction, one
    in forward direction (from source to destination) and the other in the
    reverse direction. In this configuration, the transceiver of each optical
    transponder receives the signal from one segment and transmits the
    regenerated optical signal into the adjacent segment. This configuration
    is also called cross-regeneration and each transceiver is operated in an
    uni-directional mode.
   </t>
  </list></t>
   
   <t><list style="empty">
   <t>
    Implemantations may support the change of the carrier frequency
    where the receiver may operate at a different optical frequency
    as the transmitter. The transceiver mode is a property of the
    transceiver and is applied to the transmitter and the receiver.
    Therefore, the transceiver mode is the same for the two segments
    on the two sides of the 3R regenaretor realised by two transceivers
    operated in the uni-directional mode.
   </t>
  </list></t>
    
  <figure align="center" title="Cross-3R Regenerator Example" anchor="Figure-y">
   <artwork><![CDATA[

                    Optical Transponder 1
               +-----------------------------+
               | Transceiver                 |
               |-------------+   +---------+ |
           --->| Receiver    |---|Sig. --+ | |
               |-------------+   |       | | |
           <---| Transmitter |---|Proc.<-+ | |
               |-------------+   +---------+ |
               |                             |
               +-----------------------------+
                  3R in forward direction


                    Optical Transponder 2
               +-----------------------------+
               | Transceiver                 |
               |-------------+   +---------+ |
           --->| Receiver    |---|Sig. --+ | |
               |-------------+   |       | | |
           <---| Transmitter |---|Proc.<-+ | |
               |-------------+   +---------+ |
               |                             |
               +-----------------------------+
                  3R in reverse direction
       
               Sig. Proc. = Signal Processing

]]></artwork>
  </figure>
  
  <t>
   Due to the fact that 3R regenerators are composed of an optical transponder
   pair, the capabilitiy whether an optical transponder can be used as a 3R
   regenerator is is added to the transponder capabilities. Hence, no
   additional entity is required for describing 3R regenerators in the
   TE-topology YANG model. The optical transonder capabilities regarding the 3R
   regenerator function are described by the following two YANG model attributes:
  </t>

  <t><list style="symbols"><?rfc subcompact="yes"?>
  <t>supported-termination-type</t>
  <t>supported-3r-mode</t>
  <?rfc subcompact="no"?>
  </list></t>

  <t>
   The supported-termination-type attribute describes whether the optical
   transponder can be used as tunnel terminating transponder only, as 3R
   regenerator only, or whether it can support both functions.
   The supported-3r-mode attrbute describes the configuration of the
   transponder pair forming the 3R regeneartor as described above.
  </t>
  
  <t>
   More text to be added here!
  </t>

  </section>

  <section title="WSS/Filter" anchor="sect-2.7">
  <t>
   WSS separates the incoming light input spectrally as well as
   spatially, then chooses the wavelength that is of interest by
   deflecting it from the original optical path and then couple it to
   another optical fibre port. WSS/Filter is internal to ROADM. So this
   document does not model the inside of ROADM.
  </t>

  </section>

  <section title="Optical Fiber" anchor="sect-2.8">
  <t>
   There are various optical fiber types defined by ITU-T. There are
   several fiber-level parameters that need to be factored in, such as,
   fiber-type, length, loss coefficient, pmd, connectors (in/out).
  </t>

  <t>
   ITU-T G.652 defines Standard Singlemode Fiber; G.654 Cutoff Shifted
   Fiber; G.655 Non-Zero Dispersion Shifted Fiber; G.656 Non-Zero
   Dispersion for Wideband Optical Transport; G.657 Bend-Insensitive
   Fiber. There may be other fiber-types that need to be considered.
  </t>

  </section>

  <section title="WDM-Node Architectures" anchor="sect-2.9">
  <t>
   The WDM-node architectures in today's dense wavelength division
   multiplexing (DWDM) networks can be categorized as follows:
  </t>

  <t><list style="symbols"><!--<?rfc subcompact="yes"?>-->
   <t>
    Integrated WDM-node architecture with local optical transponders
   </t>

   <t>
    Integrated WDM-node architecture with local optical transponders
    and single channel add/drop ports for remote optical transponders
   </t>

   <t>
    Disaggregated WDM-node architecture where the WDM-TE-node is
    composed of degree, add/drop, and optical transponder subsystems
    handled as separate WDM-nodes
   </t>

  <!--<?rfc subcompact="no"?>-->
  </list></t>

  <t>
   The TE topology YANG model augmentations including optical
   impairments for DWDM networks defined below intend to cover all the
   3 categories of WDM-node architectures listed above. In the case
   of a disaggregated WDM-node architecture, it is assumed that the
   optical domain controller already performs some form of abstraction
   and presents the WDM-TE-node representing the disaggregated WDM-node
   in the same way as an integrated WDM-TE-node with local optical
   transponders if the optical transponder subsystems and the add/drop
   subsystems are collocated (short fiber links not imposing any
   significant optical impairments).
  </t>

  <t>
   The different WDM-node architectures are briefly described and
   illustrated in the following subsections.
  </t>

  <t>
   [Editor's note: The modeling of remote optical transponders located
   for example in the client device with a single channel link between
   the OT and the add/drop port of the WDM-TE-node requires further
   investigations and will be addressed in a future revision of this
   document.]
  </t>
  

  <section title="Integrated WDM-node Architecture with Local Optical
   Transponders" anchor="sect-2.9.1">
  <t>
   <xref target="Figure-2"/> and <xref target="Figure-6"/> below show
   the typical architecture of an integrated WDM-node, which contains
   the optical transponders as an integral part of the WDM-node. Such
   an integrated WDM-node provides DWDM interfaces as external
   interfaces for interconnecting the device with its neighboring
   WDM-node (see OMS MCG above). The number of these interfaces denote
   also the degree of the WDM-node. A degree 3 WDM-node for example has
   3 DWDM links that interconnect the WDM-node with 3 neighboring
   WDM-nodes. Additionally, the WDM-node provides client interfaces for
   interconnecting the WDM-node with client devices such as IP routers
   or Ethernet switches. These client interfaces are the client
   interfaces of the integrated optical transponders.
  </t>

  <figure align="center" title="Integrated WDM-node Architectiure
   with Local Transponders" anchor="Figure-6"><artwork><![CDATA[
            . . . . . . . . . . . . . . . . . .
            .           WDM-TE-Node           .
      +-----.-------------------------------- .-----+
      |     .             WDM-Node            .     |
      |     .   /|  +-----------------+  |\   .     |
 Line |     .  / |--|                 |--| \  .     | Line
 WEST |  /| . |  |--|                 |--|  | . |\  | EAST
------+-/ |-.-|  |--|  photonic       |--|  |-.-| \-+-----
------+-\ |-.-|  |--|  cross-connect  |--|  |-.-| /-+-----
      |  \| . |  |--|                 |--|  | . |/  |
      |     .  \ |--|                 |--| /  .     |
      |     .   \|  +-----------------+  |/   .     |
      |     .                                 .     |
      |     .     +---+ +---+ +---+ +---+     .     |
      |     .     | O | | O | | O | | O |     .     |
      |     .     | T | | T | | T | | T |     .     |
      |     .     +---+ +---+ +---+ +---+     .     |
      |     .      | |   | |   | |   | |      .     |
      +-----.------+-+---+-+---+-+---+-+------.-----+
            . . . .|.| . |.| . |.| . |.|. . . .
                   | |   | |   | |   | |
                     Client Interfaces
]]></artwork>
  </figure>
  
  </section>

  <section title="Integrated WDM-node with Integrated Optical
   Transponders and Single Channel Add/Drop Interfaces for Remote
   Optical Transponders" anchor="sect-2.9.2">
  
  <t>
   <xref target="Figure-7"/> below shows the extreme case where all
   optical transponders are not integral parts of the WDM-node but are
   separate devices that are connected to the add/drop ports of the
   WDM-node. If the optical transponders and the WDM-node are collocated
   and if short single channel fiber links are used to interconnect the
   optical transponders with an add/drop port of the WDM-node, the
   optical domain controller may present these optical transponders in
   the same way as local  optical transponders. If, however, the optical
   impairments of the single channel fiber link between the optical
   transponder and the add/drop port of the WDM-node cannot be neglected,
   it is necessary to represent the fiber link with its optical
   impairments in the topology model This also implies that the optical
   transponders belong to a separate TE-node
  </t>
  
  <t>
   [Editor's note: this requires further study].
  </t>

  <figure align="center" title="Integrated WDM-node Architectiure with
   Remote Transponders" anchor="Figure-7"><artwork><![CDATA[
            . . . . . . . . . . . . . . . . . .
            .           WDM-TE-Node           .
      +-----.-------------------------------- .-----+
      |     .            WDM-Node             .     |
      |     .   /|  +-----------------+  |\   .     |
 Line |     .  / |--|                 |--| \  .     | Line
 WEST |  /| . |  |--|                 |--|  | . |\  | EAST
------+-/ |-.-|  |--|  photonic       |--|  |-.-| \-+-----
------+-\ |-.-|  |--|  cross-connect  |--|  |-.-| /-+-----
      |  \| . |  |--|                 |--|  | . |/  |
      |     .  \ |--|                 |--| /  .     |
      |     .   \|  +-----------------+  |/   .     |
      +-----.---------|----|---|----|---------.-----|
 Colored OT .       +-+   ++   ++   +-+       .
 line I/F   .       |     |     |     |       .
            .     +---+ +---+ +---+ +---+     .
            .     | O | | O | | O | | O |     .
            .     | T | | T | | T | | T |     .
            .     +---+ +---+ +---+ +---+     .
            . . . .|.| . |.| . |.| . |.|. . . .
                   | |   | |   | |   | |     
                     Client Interfaces
]]></artwork>
  </figure>
  </section>

  <section title="Disaggregated WDM-TE-node Subdivided into Degree,
   Add/Drop, and Optical Transponder Subsystems" anchor="sect-2.9.3">
  
  <t>
   Recently, some DWDM network operators started demanding WDM
   subsystems from their vendors. An example is the OpenROADM project
   where multiple operators and vendors are developing related YANG
   models. The subsystems of a disaggregated WDM-TE-node are:
  </t>
  
    <t>
    <list style="symbols"><?rfc subcompact="yes"?>
      <t>Single degree subsystems</t>
      <t>Add/drop subsystems</t>
      <t>Optical transponder subsystems</t>
    <?rfc subcompact="no"?>
    </list>
  </t>
  
  <t>
   These subsystems are separate network elements and each network
   element provides a separate management and control interface. The
   subsystems are typically interconnected using short fiber patch
   cables and form together a disaggregated WDM-TE-node. This
   disaggregated WDM-TE-node architecture is depicted in
   <xref target="Figure-8"/> below.
  </t>

  <t>
   As this document defines TE topology YANG model augmentations
   <xref target="RFC8795"/> for the TE topology YANG
   model provided at the north-bound interface of the optical domain
   controller, it is a valid assumption that the optical domain
   controller abstracts the subsystems of a disaggregated WDM-TE-node
   and presents the disaggregated WDM-TE-node in the same way as an
   integrated WDM-node hiding all the interconnects that are not
   relevant from an external TE topology view.
  </t>

  <figure align="center" title="Disaggregated WDM-TE-node Architecture
   with Remote Transponders" anchor="Figure-8"><artwork><![CDATA[
           . . . . . . . . . . . . . . . . .  .
           .            WDM-TE-Node           .
     +-----.----------+            +----------.-----+
     | Degree 1       |            |       Degree 2 |
Line |     .  +-----+ |            + +-----+  .     | Line
 1   |  /| .  |  W  |-|------------|-|  W  |  . |\  |  2
-----+-/ |-.--|  S  ********  ********  S  |--.-| \-+-----
-----+-\ |-.--|  S  | |    *  *    | |  S  |--.-| /-+-----
     |  \| .  |     |-|-+  *  *  +-|-|     |  . |/  |
     |     .  +-+-+-+ | |  *  *  | | +-+-+-+  .     |
     +-----.----|-----+ |  *  *  | +-----|----.-----+
           .    |       |  *  *  |       |    .
     +-----.----|-----+ |  *  *  | +-----|----.-----+
     | Degree 4 |     | |  *  *  | |     | Degree 3 |
Line |     .  +-----+ | |  *  *  | | +-----+  .     | Line
 4   |  /| .  |  W  |-|-|--*--*--+ | |  W  |  . |\  |  3
-----+-/ |-.--|  S  | | +--*--*----|-|  S  |--.-| \-+-----
-----+-\ |-.--|  S  |-|----*--*----|-|  S  |--.-| /-+-----
     |  \| .  |     | |    *  *    | |     |  . |/  |
     |     .  +--*--+ |    *  *    | +--*--+  .     |
     +-----.-----*----+    *  *    +----*-----.-----+
           .     *         *  *         *     .
           .  +--*---------*--*---------*--+  .
           .  |          ADD               |  .
           .  |          DROP              |  .
           .  +----------------------------+  .
 Colored OT  .     |     |     |     |     .
  Line I/F   .   +---+ +---+ +---+ +---+   .
             .   | O | | O | | O | | O |   .
             .   | T | | T | | T | | T |   .
             .   +---+ +---+ +---+ +---+   .
             . . .|.| . |.| . |.| . |.|. . .
                  | |   | |   | |   | |
                    Client Interfaces
]]></artwork>
  </figure>
 
  </section>

  <section title="Optical Impairments Imposed by WDM-TE-Nodes"
   anchor="sect-2.9.4">
  
  <t>
   [Editor's note: the following text still needs to be updated based
   on the agreed terminology]
  </t>
  
  <t>
   When an optical OTSi signal traverses a ROADM node, optical impairments
   are imposed on the signal by various passive or active optical components
   inside the ROADM node. Examples of optical impairments are:
  </t>
  
  <t><list style="symbols"><?rfc subcompact="yes"?>
   <t>Chromatic dispersion (CD)</t>
   <t>Polarization mode dispersion (PMD)</t>
   <t>Polarization dependent loss (PDL)</t>
   <t>Optical amplifier noise due to amplified spontaneous emission (ASE)</t>
   <t>In-band cross-talk</t>
   <t>Filtering effects (for further study)</t>
  <?rfc subcompact="no"?>
  </list></t>
  
  <t>
   A ROADM node contains a wavelength selective photonic switching function
   (WSS)that is capable of switching media channels (MCs) described in
   <xref target="sect-2.3.4"/>. These MCs can be established between two
   line ports of the ROADM or between a line port and an Add/Drop port of
   the ROADM. The Add/Drop ports of a ROADM are those ports to which optical
   transponders are connected. Typically, add/drop ports deal with a single 
   channel signal (single OTSi), but principally this could also be a group 
   of OTSi signals (OTSiG). The optical impairments associated with these MCs 
   are different and the paths of the MCs inside the ROADM node can be 
   categorized as follows:
  </t>
  
  <t><list style="symbols"><!-- <?rfc subcompact="yes"?> -->
  <t>Express path: MC path between two line ports of the ROADM
    (unidirectional)</t>
  <t>Add Path: MC path from an Add port to a line port of the ROADM</t>
  <t>Drop path: MC path from a line port to a Drop port of the ROADM</t>
  <!-- <?rfc subcompact="no"?> -->
  </list></t>
  
  <t>
   Due to the symmetrical architecture of the ROADM node, the optical
   impairments associated with the express path are typically the same
   between any two line ports of the ROADM whereas the optical impairments
   for the add and drop paths are different and therefore have to be
   modeled separately.
  </t>
 
  <t>
   The optical impairments associated with each of the three types of
   ROADM-node-internal paths described above are modeled as optical
   impairment parameter sets. These parameter sets are modeled as an
   augmentation of the te-node-attributes defined in
   <xref target ="RFC8795"/>.
   The te-node-attributes are augmented with a list of roadm-path-impairments
   for the three ROADM path types distinguished by the impairment-type. Each
   roadm-path-impairments list entry contains the set of optical impairment
   parameters for one of the three path types indicated by the impairment-type.
   For the optical feasibility calculation based on the optical impairments,
   it is necessary to know whether the optical power of the OTSi stays within
   a certain power window. This is reflected by some optical power related
   parameters such as loss parameters or power parameters, which are included
   in the optical impairment parameter sets (see tree view in
   <xref target="sect-3"/>).
  </t>
  
  <t>
   <xref target ="RFC8795"/> defines a connectivity
   matrix and a local link connectivity list for the TE node. The
   connectivity matrix describes the connectivity for the express paths
   between the different lines of the ROADM and the local link connectivity
   list describes the connectivity for the Add and Drop paths of the ROADM.
   These matrices are augmented with a new roadm-path-impairment matrix
   element, an add-path-impairment, and drop-path-impairment matrix element,
   respectively, which are defined as a pointer to the corresponding entry
   in the roadm-path-impairments list (leaf-ref).
  </t>

  <t>
   [Editor's note: this section is still work in progress]
  </t>

  </section>
  
  </section>

  <section title="Optical Protection Architectures" anchor="Prot">
  
  <t>
   The YANG model defined in this document supports the following
   optical protection architectures:
  </t>
    
  <t><list style="symbols"><?rfc subcompact="yes"?>
   <t>Individual OTSi protection</t>
   <t>OMS MCG protection = TE-link protection between adjacent
   WDM-TE-nodes</t>
  <?rfc subcompact="no"?>
  </list></t>

  <t>
   [Editor's note: this section is still work in progress]
  </t>
 
  <section title="Individual OTSi Protection" anchor="OTSi_prot">
  
  <t>
   Individual OTSi protection is a protection architecture where an
   individual OTSi signal is protected as described in Appendix III of
   ITU-T Recommendation G.873.1 <xref target ="G.873.1"/>. 
   This protection architecture requires dedicated photonic protection
   functions in the optical domain that are typically provided by
   dedicated protection hardware. These photonic protection functions
   are a photonic splitter function splitting the OTSi signal in
   transmit direction and a photonic selector function selecting the
   OTSi signal in receive direction from one of the two protection
   legs between the two protection functions terminating the individual
   OTSi protection.
   This individual OTSi protection scheme can be considered as a
   photonic 1+1 protection scheme (1+1 sub-network connection
   protection (SNCP) in ITU-T terminology).
  </t>
  
  <t>
   In order to achieve short protection switching times, it is necessary
   that the OTSi signals of the two legs are identical in terms of
   wavelength, modulation format, FEC, etc., which means no receiver
   configuration changes when a protection switch at the selector occurs
   selecting the other leg. This is important when 3R regenerators are
   needed between the two end-points terminating the protected segment,
   which typically is end-to-end.
  </t>
  
  <t>
   In case of individual OTSi protection, there are two end-to-end MC
   paths associated with the OTSi signal. In the YANG model, this is
   modeled as a leaf list of the otsi providing the e2e-mc-path-id for
   the two end-to-end MC paths associated with the individually
   protected otsi.
  </t>
  
  <t>Individual OTSi protection use cases:</t>
    <ol type="(%i)">
      <li>OT and OTSi protection function are an integral part of the WDM-TE-node</li>
      <li>OT and OTSi protection/ROADM functions are in two adjacent WDM-TE-node (remote OT)</li>
      <li>OT and OTSi protection function are both in an adjacent WDM-TE-node (protected remote OT)</li>
    </ol>
  
  <t>
   The different use cases are described in following sub-sections and
   examples are provided how these uses cases can be modeled properly
   using the optical impairment aware TE-topology YANG data model.
  </t>
  
  <section anchor="Protection UC (i)">
    <name>OT and OTSi protection function are an integral part of the
    WDM-TE-node</name>
  
  <t>
   This use case is based on the architecture illustrated in
   <xref target="Figure-6"/> and the following entities are all integral
   parts of the WDM-TE-node:
   
    <ul spacing="compact">
      <li>Local optical transponder</li>
      <li>Splitter/selector protection function</li>
      <li>ROADM function</li>
    </ul>
    
   <xref target="Figure-11"/> illustrates such a WDM-TE-node
   configuration in transmit/forward direction where the protection
   function is an optical splitter and <xref target="Figure-12"/>
   illustrates the same WDM-TE-node configuration in receive/reverse
   direction where the protection function is an optical selector
   selecting one of the two incoming OTSi signals and switching to the
   other incoming OTSi signal when the optical power of the selected
   OTSi signal drops below a pre-defined threshold.
  </t>
  
  <t>
   The TE-topology YANG model has been augmented to describe this
   protection architecture. The already existing optional
   protection-type leaf of the TTP associated with the optical
   transceiver is used to indicate whether the TTP is protected, i.e.,
   whether it is connected to a protection function or whether it is
   unprotected, i.e., whether it is directly connected to an add-drop
   port of the ROADM function in the WDM-TE-node.
  </t>
  
  <t>
   For unprotected TTPs associated with an optical transceiver, the
   local-link-connectivity list describes the potential connectivity
   between the TTP and the LTPs of the WDM-TE-node that are the local
   end-points of the TE-links (OMS MCGs) interconnecting the
   WDM-TE-node with its neighbors, also often called degrees of the
   WDM-TE-node as opposed to its add-drop ports.
  </t>
  
  <t>
   For protected TTPs, the local-link-connectivity list has been
   augmented such that is is capable of describing the potential
   connectivity not only between the TTP and a single LTP a
   (unprotected case) but is now capable to describe the potential
   connectivity to additional LTPs including the related optical
   impairments. If the optical impairments are the same for all
   local-link-connectivity list entries for a particular TTP, which
   is usually the case, the optical impairments shall be omitted for
   the additional LTPs leading to a more compact topology description.
   If the optical impairments are different, however, they can be
   described for each additional LTP entry separately.
  </t>
  
  <t>
   A local-link-connectivity list example for a protected TTP in JSON
   format is provided in <xref target="JSON Examples"/>.
  </t>
    
  <figure align="center" title="OT and OTSi protection function are an
    integral part of the WDM-TE-node (transmit direction)" anchor="Figure-11">
    <artwork><![CDATA[
                            WDM-TE-Node
   +---------------------------------------------------------+
   |                                       ROADM             |
   |      Local OT        Splitter    +--------------+       |
   |   +------------+    +--------+   |              | Line  |
   |   |         TTP|    |     ---o-->o------\       | LTP 1 |
   |   |       +----|    |    /   |   |       \------o-------o->
 --o-->|       | Tx o--->o---o    |   |              |       |
   |   |       +----|    |    \   |   |              |       |
 <-o---|       | Rx o    |     ---o-->o---\          | Line  |
   |   |       +----|    +--------+   |    \         | LTP 2 |
   |   |            |                 |     \        o-------o->
   |   +------------+        internal |      \       |       |
   |                         AD ports o       \      |       |
   |                                  |        \     | Line  |
   |                                  |         \    | LTP 3 |
   |                                  |          \---o-------o->
   |                                  o              |       |
   |                                  |              |       |
   |                                  +--------------+       |
   +---------------------------------------------------------+
   
]]> </artwork>
  </figure>

  <figure align="center" title="OT and OTSI protection function are an
    integral part of the WDM-TE-node (receive direction)" anchor="Figure-12">
    <artwork><![CDATA[
                            WDM-TE-Node
   +---------------------------------------------------------+
   |      Local OT                                           |
   |   +------------+                      ROADM             |
   |   |            |     Selector    +--------------+       |
   |   |       +----|    +--------+   |              | Line  |
 --o-->|       | Tx o    |     ---o<--o------\       | LPT 1 |
   |   |       +----|    |    /   |   |       \------o-------o<-
 <-o---|       | Rx o<---o---o    |   |              |       |
   |   |       +----|    |    \   |   |              |       |
   |   |         TTP|    |     ---o<--o---\          | Line  |
   |   +------------+    +--------+   |    \         | LTP 2 |
   |                                  |     \        o-------o<-
   |                         internal |      \       |       |
   |                         AD ports o       \      |       |
   |                                  |        \     | Line  |
   |                                  |         \    | LTP 3 |
   |                                  |          \---o-------o<-
   |                                  o              |       |
   |                                  |              |       |
   |                                  +--------------+       |
   +---------------------------------------------------------+
   
]]> </artwork>
  </figure>
  
  </section>
  
  <section anchor="Protection UC (ii)">
    <name>OT and OTSi protection/ROADM functions are in two adjacent
    WDM-TE-node (remote OT)</name>
  
  <t>
   This use case is based on the architecture illustrated in
   <xref target="Figure-7"/> where the optical transponder is not part
   of the WDM-TE-node containing the ROADM function (WDM-TE-Node-2) but
   is part of a separate WDM-TE-node (WDM-TE-Node-1) containing one or
   more optical transponders (remote OTs). WDM-TE-Node-2 contains:
   
    <ul spacing="compact">
      <li>Splitter/selector protection function</li>
      <li>ROADM function</li>
    </ul>
    
   <xref target="Figure-13"/> illustrates such a network configuration
   in transmit/forward direction showing the two WDM-TE-nodes where the
   protection function is the optical splitter in WDM-TE-Node-2 and
   <xref target="Figure-14"/> illustrates the same network configuration
   in receive/reverse direction where the protection function is the
   optical selector in WDM-TE-Node-2 selecting one of the two incoming
   OTSi signals and switching to the other incoming OTSi signal when the
   optical power of the selected OTSi signal drops below a pre-defined
   threshold.
  </t>
  
  <t>
   In the network configuration shown in <xref target="Figure-13"/> and
   <xref target="Figure-14"/>, respectively, the two WDM-TE-nodes are
   interconnected via a TE-link carrying a single OTSi signal.
   This TE-link interconnects the remote OT with an add-drop port of
   WDM-TE-Node-2 and in the following the qualifier "add-drop" is used
   to refer to that LTP as opposed to the line LTPs representing degrees
   of WDM-TE-Node-2.
   Similar to the protected TTP in <xref target="Protection UC (i)"/>,
   the optional protection-type leaf is used to indicate whether the
   add-drop LTP is connected to a protection function and then to two
   line LTPs via the ROADM function inside WDM-TE-Node-2 or whether it
   is connected to a single line LTP via the ROADM function inside
   WDM-TE-Node-2 (unprotected add-drop LTP). While the protection-type
   attribute was already defined for the TTP, the YANG model has been
   augmented to also support this optional attribute for the LTP.
  </t>
  
  <t>
   For protected LTPs, the connectivity-matrix has been augmented such
   that it is capable of describing the potential connectivity not only
   from an add-drop LTP to a single line LTP (unprotected case) but is
   now capable to describe the potential connectivity to additional line
   LTPs (protected case) including the related optical impairments. If
   the optical impairments are the same from the protected ad-drop LTP
   to all line LTPs, which is usually the case, the optical impairments
   shall be omitted for the additional LTPs leading to a more compact
   connectivity matrix description. If the optical impairments are
   different, however, they can be described for each additional LTP
   separately.
  </t>
  
  <figure align="center" title="OT and OTSi protection/ROADM functions are in
     two adjacent WDM-TE-node (remote OT, transmit direction)" anchor="Figure-13">
    <artwork><![CDATA[

      WDM-TE-Node-1                      WDM-TE-Node-2
   +----------------+      +---------------------------------------+
   |                |      |                     ROADM             |
   |      Remote OT |      |    Selector    +--------------+       |
   |   +------------+      |   +--------+   |              | Line  |
   |   |         TTP|      |AD |     ---o-->o------\       | LTP 1 |
   |   |       +----|      |LTP|    /   |   |       \------o-------o->
 --o-->|       | Tx o----->o-->o---o    |   |              |       |
   |   |       +----|      |   |    \   |   |              |       |
 <-o---|       | Rx o      |   |     ---o-->o---\          | Line  |
   |   |       +----|      |   +--------+   |    \         | LTP 2 |
   |   |            |      |                |     \        o-------o->
   |   +------------+      |AD LTP          |      \       |       |
   |                |      o----------------o       \      |       |
   |                |      |                |        \     | Line  |
   |                |      |unprot. AD LTPs |         \    | LTP 3 |
   |                |      |                |          \---o-------o->
   |                |      o----------------o              |       |
   |                |      |AD LTP          |              |       |
   |                |      |                +--------------+       |
   +----------------+      +---------------------------------------+
   
]]> </artwork>
  </figure>
  
  
  <figure align="center" title="OT and OTSi protection/ROADM functions are in
     two adjacent WDM-TE-node (remote OT, receive direction)" anchor="Figure-14">
    <artwork><![CDATA[

      WDM-TE-Node-1                      WDM-TE-Node-2
   +----------------+      +---------------------------------------+
   |      Remote OT |      |                                       |
   |   +------------+      |                     ROADM             |
   |   |            |      |    Selector    +--------------+       |
   |   |       +----|      |   +--------+   |              | Line  |
 --o-->|       | Tx o      |   |     ---o<--o------\       | LTP 1 |
   |   |       +----|      |   |    /   |   |       \------o-------o<-
 <-o---|       | Rx o<-----o<--o---o    |   |              |       |
   |   |       +----|      |AD |    \   |   |              |       |
   |   |         TTP|      |LTP|     ---o<--o---\          | Line  |
   |   +------------+      |   +--------+   |    \         | LTP 2 |
   |                |      |                |     \        o-------o<-
   |                |      |AD LTP          |      \       |       |
   |                |      o----------------o       \      |       |
   |                |      |                |        \     | Line  |
   |                |      |unprot. AD LTPs |         \    | LTP 3 |
   |                |      |                |          \---o-------o<-
   |                |      o----------------o              |       |
   |                |      |AD LTP          |              |       |
   |                |      |                +--------------+       |
   +----------------+      +---------------------------------------+
      
]]> </artwork>
  </figure>
  
  </section>

  <section anchor="Protection UC (iii)">
    <name>OT and protection function are both in an adjacent WDM-TE-node
    (protected remote OT)</name>
  
  <t>
   The use case illustrated in <xref target="Figure-15"/> is similar to
   the use case in <xref target="Protection UC (i)"/>. The difference
   compared to use case (i) is  that WDM-TE-Node-1 does not contain the
   ROADM function but contains:
   
    <ul spacing="compact">
      <li>Optical transponder function including the transceiver</li>
      <li>Splitter/selector protection function</li>
    </ul>
   
   WDM-TE-Node-1 can be a data center device or a router router device
   that supporting 1+1 OTSi protection for its OTs while WDM-TE-Node-2
   is a WDM-TE-node providing add-drop ports for remote OTs as depicted
   in <xref target="Figure-7"/>. WDM-TE-Node-1 and WDM-TE-Node-2 are
   interconnected via two separate TE-links, each carrying a single
   OTSi signal. The protection configuration for the protected TTP in
   WDM-TE-Node-1 can be described in the same way as for use case (i)
   using the local-link-connectivity list.
  </t>
  
  
  <figure align="center" title="OT and OTSI protection function are both
    in an adjacent WDM-TE-node (protected remote OT, transmit direction)" anchor="Figure-15">
    <artwork><![CDATA[

           WDM-TE-Node-1                        WDM-TE-Node-2
   +-----------------------------+      +---------------------------+
   |      protected              |      |         ROADM             |
   |      remote OT      Splitter|      |    +--------------+       |
   |   +------------+   +--------+      |AD  |              | Line  |
   |   |         TTP|   |     ---o----->o----o------\       | LTP 1 |
   |   |       +----|   |    /LTP|      |LTP |       \------o-------o->
 --o-->|       | Tx o-->o---o    |      |    |              |       |
   |   |       +----|   |    \   |      |AD  |              |       |
 <-o---|       | Rx o   |     ---o----->o----o---\          | Line  |
   |   |       +----|   |     LTP|      |LTP |    \         | LTP 2 |
   |   |            |   +--------+      |    |     \        o-------o->
   |   +------------+            |      |    |      \       |       |
   |                             |      o----o       \      |       |
   |                             |      |AD  |        \     | Line  |
   |                             |      |LTPs|         \    | LTP 3 |
   |                             |      |    |          \---o-------o->
   |                             |      o----o              |       |
   |                             |      |    |              |       |
   |                             |      |    +--------------+       |
   +-----------------------------+      +---------------------------+
   
]]> </artwork>
  </figure>

  </section>
  
  </section>

  <section title="OMS MCG protection" anchor="TE-link_prot">
  
  <t>
   [Editor's note: this section is still work in progress]
  </t>
  
  <t>
   OMS MCG protection is a 1+1 protection architecture where a TE-link
   between two adjacent WDM-TE-nodes is 1+1 protected. Such a 1+1
   protected TE-link composed of an underlying primary and secondary
   TE-link is shown in <xref target="OMS_MCG_prot"/> together with an
   unprotected TE-link between the two adjacent WDM-TE-Nodes.
  </t>
  
  <t>
   1+1 OMS MCG protection is a local protection scheme, which can be
   modeled based on TE-link properties already defined in
   <xref target="RFC8795"/>. The 1+1 protected TE-link is associated
   with the two underlying TE-links forming the 1+1 protection group
   together with the splitter/combiner functions in the adjacent
   WDM-TE-Nodes. The splitter/combiner functions are not modeled as
   separate entities in the model. Any optical impairments imposed by
   the splitter and combiner functions are included in the optical
   impairments of the ROADM functions in the two adjacent WDM-TE-Nodes
   (connectivity matrix and LLCL, respectively).
  </t>
  
  <t>
   Alternatively, it is also possible to model the 1+1 OMS MCG
   protection as single protected TE-link abstracting the two
   underlying physical links as well as the splitter/combiner functions
   in the two adjacent WDM-TE-Nodes. Similarly, are any optical
   impairments imposed by the splitter and combiner functions
   included in the optical impairments of the ROADM functions in the
   two adjacent WDM-TE-Nodes (connectivity matrix and LLCL,
   respectively).
  </t>
  
  <figure align="center" title="Two WDM-TE-Nodes with a protected
   and an unprotected OMS MCG (TE-link)" anchor="OMS_MCG_prot">
    <artwork><![CDATA[

         WDM-TE-Node-1                     WDM-TE-Node-2
   +-----------------------+         +-----------------------+
   |     ROADM     Splitter|         |Selector     ROADM     |
   |   +-------+   +-------+  prot.  +-------+   +-------+   |
   |   |       |   |    -->o-------->o-->    |   |       |   |
   |   |       |   |   /   |  prim.  |   \   |   |       |   |
   |   |       o-->o--o    |         |    o--o-->o       |   |
   |   |       |   |   \   |  second.|   /   |   |       |   |
   |   |       |   |    -->o-------->o-->    |   |       |   |
   |   |       |   +-------+         +-------+   |       |   |
   |   |       |   Selector| Line 1  |Splitter   |       |   |
   |   |       |   +-------+         +-------+   |       |   |
   |   |       |   |    <--o<--------o<--    |   |       |   |
   |   |       |   |   /   |  prim.  |   \   |   |       |   |
   |   |       o<--o--o    |         |    o--o<--o       |   |
   |   |       |   |   \   |  second.|   /   |   |       |   |
   |   |       |   |    <--o<--------o<--    |   |       |   |
   |   |       |   +-------+ TE-link +-------+   |       |   |
   |   |       |           |         |           |       |   |
   |   |       |           | unprot. |           |       |   |     
   |   |       o---------->o-------->o---------->o       |   |
   |   |       |           | Line 2  |           |       |   |
   |   |       o<----------o<--------o<----------o       |   |
   |   |       |           | TE-link |           |       |   |
   |   |       |           |         |           |       |   |
   |   +-------+           |         |           +-------+   |
   |                       |         |                       |
   +-----------------------+         +-----------------------+
   
]]> </artwork>
  </figure>
  
  <section title="OMS MCG Protection Modeled as Protected TE-link with
  underlying TE-links" anchor="abstr_TE-link_prot">
  
  <t>
   [Editor's note: this sub-section is still work in progress]
  </t>

  <t>
   This modeling approach models the 1+1 protected TE-link as an
   additional TE-link entity on top of the primary and secondary
   TE-link between the two adjacent WDM-TE-Nodes terminating the
   1+1 OMS MCG protection group formed by these two TE-links and the
   splitter/combiner functions in the two nodes. This protected
   TE-link is associated with underlying primary and secondary TE-links
   forming the 1+1 protection group. The following "te-link-attributes"
   already defined in <xref target="RFC8795"/> and
   <xref target="RFC8776"/> can be used for modeling the 1+1 protected
   TE-link ("te-link-attributes" augmentation copied from
   <xref target="RFC8795"/>:
   
  <sourcecode name="TE-topology subtree" type="text" markers="false">
  <![CDATA[
  augment /nw:networks/nw:network/nt:link:
  +--rw te!
     +--rw te-link-attributes
     |  ....................
     |  +--rw underlay {te-topology-hierarchy}?
     |  |  +--rw enabled?                     boolean
     |  |  +--rw primary-path
     |  |  |  +--rw network-ref?    leafref
     |  |  |     ....................
     |  |  +--rw backup-path* [index]
     |  |  |  +--rw index           uint32
     |  |  |  +--rw network-ref?    leafref
     |  |  |     ....................
     |  |  +--rw protection-type?             identityref
  ]]>
  </sourcecode>
  
  <t>
   These attributes are used as follows:
  </t>
   
    <ul spacing="compact">
      <li>"underlay": the presence of this container is indicating that
        an underlying protection scheme exists</li>
      <li>"enabled": (boolean) is set to 'true'</li>
      <li>"primary-path": is referencing the primary OMS MCG (TE-link)
      </li>
      <li>"backup-path": is referencing the secondary OMS MCG (TE-link)
      </li>
      <li>"link-protection-type" (identityref) set to
        'link-protection-1-plus-1' as defined in
        <xref target="RFC8776"/>
      </li>
    </ul>
  </t>
  
  <t>
   The optical impairments for the underlying primary and secondary
   TE-link can be described as for unprotected TE-links. It may also be
   possible to only describe the optical impairments for the 1+1
   protected TE-link. In this case the optical impairments of the worse
   of the two underlying TE-links shall be used. This should be 
   sufficient as input for path computation (worst case optical
   feasibility consideration).
  </t>
  
  <t>
   Any optical impairments imposed by the splitter and combiner
   functions are included in the optical impairments of the ROADM
   functions in the two adjacent WDM-TE-Nodes (connectivity matrix and
   LLCL, respectively).
  </t>
  
  </section>
  
  <section title="OMS MCG Protection Modeled as Single Protected TE-link"
  anchor="Single_TE-link_prot">
  
  <t>
   [[Editor's note: this sub-section is still work in progress]
  </t>
  
  <t>
   This modeling approach abstracts the two physical links carrying the
   same OMS MCG and the splitter/combiner functions in the two
   WDM-TE-Nodes forming the protection group into a single TE-link. If
   this modeling approach is used the "te-link-attributes" already
   defined in <xref target="RFC8795"/> and <xref target="RFC8776"/> are
   used as follows:
   
    <ul spacing="compact">
      <li>"underlay": this container must not be present</li>
      <li>"link-protection-type" (identityref) set to
      'link-protection-1-plus-1' as defined in <xref target="RFC8776"/>
      </li>
    </ul>
   
   The optical impairments exposed for this 1+1 protected TE-link are
   typically based on the optical impairments of the worse of the two
   underlying physical links. The optical impairments imposed by the
   splitter and combiner functions can also be taken into account as
   optical impairments of the 1+1 protected TE-link. It may also be
   possible to model the optical impairments imposed by the splitter
   and combiner functions as contribution to the optical impairments of
   the ROADM functions in the two adjacent WDM-TE-Nodes (connectivity
   matrix and LLCL, respectively)
  </t>
  
  </section>
  
  </section>
  
  </section>
  
  </section>
  
  <section title="YANG Model (Tree Structure)" anchor="sect-3">
  
  <t>
   [Editor's note: tree view below always has to be updated before submitting a new revision!]
  </t>
  
  <sourcecode name="ietf-optical-impairment-topolog.tree" type="text" markers="false">
    <![CDATA[
module: ietf-optical-impairment-topology

  augment /nw:networks/nw:network/nw:network-types/tet:te-topology:
    +--rw optical-impairment-topology!
  augment /nw:networks/nw:network:
    +--ro otsi-group* [otsi-group-id]
       +--ro otsi-group-id    string
       +--ro otsi* [otsi-carrier-id]
          +--ro otsi-carrier-id           uint16
          +--ro otsi-carrier-frequency?   union
          +--ro nmc-path-id*              uint16
  augment /nw:networks/nw:network/nw:node:
    +--ro transponder* [transponder-id]
    |  +--ro transponder-id                   uint32
    |  +--ro termination-type-capabilities?   enumeration
    |  +--ro supported-3r-mode?               enumeration
    |  +--ro transceiver* [transceiver-id]
    |     +--ro transceiver-id                 uint32
    |     +--ro supported-modes
    |     |  +--ro supported-mode* [mode-id]
    |     |     +--ro mode-id                      string
    |     |     +--ro (mode)
    |     |        +--:(G.698.2)
    |     |        |  +--ro standard-mode?         standard-mode
    |     |        +--:(organizational-mode)
    |     |        |  +--ro organizational-mode
    |     |        |     +--ro operational-mode?
    |     |        |     |       operational-mode
    |     |        |     +--ro organization-identifier?
    |     |        |     |       organization-identifier
    |     |        |     +--ro min-central-frequency?
    |     |        |     |       frequency-thz
    |     |        |     +--ro max-central-frequency?
    |     |        |     |       frequency-thz
    |     |        |     +--ro transceiver-tunability?
    |     |        |     |       frequency-ghz
    |     |        |     +--ro tx-channel-power-min?      dbm-t
    |     |        |     +--ro tx-channel-power-max?      dbm-t
    |     |        |     +--ro rx-channel-power-min?      dbm-t
    |     |        |     +--ro rx-channel-power-max?      dbm-t
    |     |        |     +--ro rx-total-power-max?        dbm-t
    |     |        +--:(explicit-mode)
    |     |           +--ro explicit-mode
    |     |              +--ro supported-modes
    |     |              |  +--ro supported-application-codes*
    |     |              |  |       -> ../../../mode-id
    |     |              |  +--ro supported-organizational-modes*
    |     |              |          -> ../../../mode-id
    |     |              +--ro line-coding-bitrate?
    |     |              |       identityref
    |     |              +--ro bitrate?
    |     |              |       uint16
    |     |              +--ro max-polarization-mode-dispersion?
    |     |              |       decimal64
    |     |              +--ro max-chromatic-dispersion?
    |     |              |       decimal64
    |     |              +--ro chromatic-dispersion-penalty* []
    |     |              |  +--ro chromatic-dispersion    union
    |     |              |  +--ro penalty-value           union
    |     |              +--ro polarization-dispersion-penalty* []
    |     |              |  +--ro polarization-mode-dispersion
    |     |              |  |       union
    |     |              |  +--ro penalty-value
    |     |              |          union
    |     |              +--ro max-diff-group-delay?
    |     |              |       uint32
    |     |              +--ro max-pol-dependent-loss-penalty* []
    |     |              |  +--ro max-polarization-dependent-loss
    |     |              |  |       power-in-db-or-null
    |     |              |  +--ro penalty-value
    |     |              |          union
    |     |              +--ro available-modulation-type?
    |     |              |       identityref
    |     |              +--ro min-OSNR?
    |     |              |       snr
    |     |              +--ro min-Q-factor?
    |     |              |       int32
    |     |              +--ro available-baud-rate?
    |     |              |       uint32
    |     |              +--ro roll-off?
    |     |              |       decimal64
    |     |              +--ro min-carrier-spacing?
    |     |              |       frequency-ghz
    |     |              +--ro available-fec-type?
    |     |              |       identityref
    |     |              +--ro fec-code-rate?
    |     |              |       decimal64
    |     |              +--ro fec-threshold?
    |     |              |       decimal64
    |     |              +--ro in-band-osnr?
    |     |              |       snr
    |     |              +--ro out-of-band-osnr?
    |     |              |       snr
    |     |              +--ro tx-polarization-power-difference?
    |     |              |       power-in-db
    |     |              +--ro polarization-skew?
    |     |              |       decimal64
    |     |              +--ro min-central-frequency?
    |     |              |       frequency-thz
    |     |              +--ro max-central-frequency?
    |     |              |       frequency-thz
    |     |              +--ro transceiver-tunability?
    |     |              |       frequency-ghz
    |     |              +--ro tx-channel-power-min?
    |     |              |       dbm-t
    |     |              +--ro tx-channel-power-max?
    |     |              |       dbm-t
    |     |              +--ro rx-channel-power-min?
    |     |              |       dbm-t
    |     |              +--ro rx-channel-power-max?
    |     |              |       dbm-t
    |     |              +--ro rx-total-power-max?
    |     |                      dbm-t
    |     +--ro configured-mode?
    |     |       -> ../supported-modes/supported-mode/mode-id
    |     +--ro tx-channel-power?              union
    |     +--ro rx-channel-power?              union
    |     +--ro rx-total-power?                union
    |     +--ro outgoing-otsi
    |     |  +--ro otsi-group-ref?
    |     |  |       -> ../../../../../otsi-group/otsi-group-id
    |     |  +--ro otsi-ref?         leafref
    |     +--ro incoming-otsi
    |     |  +--ro otsi-group-ref?
    |     |  |       -> ../../../../../otsi-group/otsi-group-id
    |     |  +--ro otsi-ref?         leafref
    |     +--ro configured-termination-type?   enumeration
    +--ro regen-group* [group-id]
       +--ro group-id           uint32
       +--ro regen-metric?      uint32
       +--ro transponder-ref*   -> ../../transponder/transponder-id
  augment /nw:networks/nw:network/nt:link/tet:te
            /tet:te-link-attributes:
    +--ro OMS-attributes
       +--ro generalized-snr?                        l0-types:snr
       +--ro equalization-mode                       identityref
       +--ro (power-param)?
       |  +--:(channel-power)
       |  |  +--ro nominal-carrier-power?
       |  |          l0-types:power-in-dbm-or-null
       |  +--:(power-spectral-density)
       |     +--ro nominal-power-spectral-density?   union
       +--ro media-channel-group* [i]
       |  +--ro i                 int16
       |  +--ro media-channels* [flexi-n]
       |     +--ro flexi-n           l0-types:flexi-n
       |     +--ro flexi-m?          l0-types:flexi-m
       |     +--ro otsi-group-ref?
       |     |       -> /nw:networks/network/otsi-group/otsi-group-id
       |     +--ro otsi-ref* []
       |     |  +--ro otsi-carrier-ref?   leafref
       |     |  +--ro nmc-path-ref*       leafref
       |     +--ro delta-power?      l0-types:power-in-dbm-or-null
       +--ro OMS-elements* [elt-index]
          +--ro elt-index                 uint16
          +--ro oms-element-uid?          union
          +--ro reverse-element-ref
          |  +--ro link-ref?
          |  |       -> ../../../../../../../nt:link/link-id
          |  +--ro oms-element-ref*   leafref
          +--ro (element)
             +--:(amplifier)
             |  +--ro geolocation
             |  |  +--ro altitude?    int64
             |  |  +--ro latitude?    geographic-coordinate-degree
             |  |  +--ro longitude?   geographic-coordinate-degree
             |  +--ro amplifier
             |     +--ro type-variety    string
             |     +--ro operational
             |        +--ro amplifier-element* []
             |           +--ro name?
             |           |       string
             |           +--ro frequency-range
             |           |  +--ro lower-frequency    frequency-thz
             |           |  +--ro upper-frequency    frequency-thz
             |           +--ro actual-gain
             |           |       l0-types:power-in-db-or-null
             |           +--ro tilt-target
             |           |       l0-types:decimal-2-digits-or-null
             |           +--ro out-voa
             |           |       l0-types:power-in-db-or-null
             |           +--ro in-voa
             |           |       l0-types:power-in-db-or-null
             |           +--ro total-output-power
             |           |       l0-types:power-in-db-or-null
             |           +--ro (power-param)?
             |           |  +--:(channel-power)
             |           |  |  +--ro nominal-carrier-power?
             |           |  |          l0-types:power-in-dbm-or-null
             |           |  +--:(power-spectral-density)
             |           |     +--ro nominal-power-spectral-density?
             |           |             union
             |           +--ro raman-direction?
             |           |       enumeration
             |           +--ro raman-pump* []
             |              +--ro frequency?   l0-types:frequency-thz
             |              +--ro power?
             |                      l0-types:decimal-2-digits-or-null
             +--:(fiber)
             |  +--ro fiber
             |     +--ro type-variety    string
             |     +--ro length
             |     |       l0-types:decimal-2-digits-or-null
             |     +--ro loss-coef
             |     |       l0-types:decimal-2-digits-or-null
             |     +--ro total-loss      l0-types:power-in-db-or-null
             |     +--ro pmd?
             |     |       l0-types:decimal-2-digits-or-null
             |     +--ro conn-in?        l0-types:power-in-db-or-null
             |     +--ro conn-out?       l0-types:power-in-db-or-null
             +--:(concentratedloss)
                +--ro concentratedloss
                   +--ro loss    l0-types:power-in-db-or-null
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:tunnel-termination-point:
    +--ro ttp-transceiver* [transponder-ref transceiver-ref]
       +--ro transponder-ref
       |       -> ../../../../transponder/transponder-id
       +--ro transceiver-ref    leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:tunnel-termination-point:
    +--ro sliceable-transponder-list* [carrier-id]
       +--ro carrier-id    uint32
  augment /nw:networks/nw:network/nw:node/nt:termination-point:
    +--rw protection-type?   identityref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:te-node-attributes:
    +--ro roadm-path-impairments* [roadm-path-impairments-id]
       +--ro roadm-path-impairments-id    uint32
       +--ro (impairment-type)?
          +--:(roadm-express-path)
          |  +--ro roadm-express-path* []
          |     +--ro frequency-range
          |     |  +--ro lower-frequency    frequency-thz
          |     |  +--ro upper-frequency    frequency-thz
          |     +--ro roadm-pmd?                union
          |     +--ro roadm-cd?                 union
          |     +--ro roadm-pdl?
          |     |       l0-types:power-in-db-or-null
          |     +--ro roadm-inband-crosstalk?
          |     |       l0-types:power-in-db-or-null
          |     +--ro roadm-maxloss?
          |             l0-types:power-in-db-or-null
          +--:(roadm-add-path)
          |  +--ro roadm-add-path* []
          |     +--ro frequency-range
          |     |  +--ro lower-frequency    frequency-thz
          |     |  +--ro upper-frequency    frequency-thz
          |     +--ro roadm-pmd?                union
          |     +--ro roadm-cd?                 union
          |     +--ro roadm-pdl?
          |     |       l0-types:power-in-db-or-null
          |     +--ro roadm-inband-crosstalk?
          |     |       l0-types:power-in-db-or-null
          |     +--ro roadm-maxloss?
          |     |       l0-types:power-in-db-or-null
          |     +--ro roadm-pmax?
          |     |       l0-types:power-in-dbm-or-null
          |     +--ro roadm-osnr?               l0-types:snr-or-null
          |     +--ro roadm-noise-figure?       union
          +--:(roadm-drop-path)
             +--ro roadm-drop-path* []
                +--ro frequency-range
                |  +--ro lower-frequency    frequency-thz
                |  +--ro upper-frequency    frequency-thz
                +--ro roadm-pmd?                union
                +--ro roadm-cd?                 union
                +--ro roadm-pdl?
                |       l0-types:power-in-db-or-null
                +--ro roadm-inband-crosstalk?
                |       l0-types:power-in-db-or-null
                +--ro roadm-maxloss?
                |       l0-types:power-in-db-or-null
                +--ro roadm-minloss?
                |       l0-types:power-in-db-or-null
                +--ro roadm-typloss?
                |       l0-types:power-in-db-or-null
                +--ro roadm-pmin?
                |       l0-types:power-in-dbm-or-null
                +--ro roadm-pmax?
                |       l0-types:power-in-dbm-or-null
                +--ro roadm-ptyp?
                |       l0-types:power-in-dbm-or-null
                +--ro roadm-osnr?               l0-types:snr-or-null
                +--ro roadm-noise-figure?       union
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:information-source-entry/tet:connectivity-matrices:
    +--ro roadm-path-impairments?   leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:information-source-entry/tet:connectivity-matrices
            /tet:connectivity-matrix:
    +--ro roadm-path-impairments?   leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:te-node-attributes/tet:connectivity-matrices:
    +--ro roadm-path-impairments?
            -> ../../roadm-path-impairments/roadm-path-impairments-id
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:te-node-attributes/tet:connectivity-matrices
            /tet:connectivity-matrix:
    +--ro roadm-path-impairments?   leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:te-node-attributes/tet:connectivity-matrices
            /tet:connectivity-matrix/tet:from:
    +--ro additional-ltp* [ltp-ref]
       +--ro ltp-ref
       |       -> ../../../../../../../nt:termination-point/tp-id
       +--ro roadm-path-impairments?   leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:te-node-attributes/tet:connectivity-matrices
            /tet:connectivity-matrix/tet:to:
    +--ro additional-ltp* [ltp-ref]
       +--ro ltp-ref
       |       -> ../../../../../../../nt:termination-point/tp-id
       +--ro roadm-path-impairments?   leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:tunnel-termination-point
            /tet:local-link-connectivities:
    +--ro add-path-impairments?    leafref
    +--ro drop-path-impairments?   leafref
  augment /nw:networks/nw:network/nw:node/tet:te
            /tet:tunnel-termination-point
            /tet:local-link-connectivities
            /tet:local-link-connectivity:
    +--ro add-path-impairments?    leafref
    +--ro drop-path-impairments?   leafref
    +--ro llc-transceiver* [ttp-transponder-ref ttp-transceiver-ref]
    |  +--ro ttp-transponder-ref
    |  |       -> ../../../../ttp-transceiver/transponder-ref
    |  +--ro ttp-transceiver-ref
    |  |       -> ../../../../ttp-transceiver/transceiver-ref
    |  +--ro is-allowed?              boolean
    |  +--ro add-path-impairments?    leafref
    |  +--ro drop-path-impairments?   leafref
    +--ro additional-ltp* [ltp-ref]
       +--ro ltp-ref
       |       -> ../../../../../../nt:termination-point/tp-id
       +--ro add-path-impairments?    leafref
       +--ro drop-path-impairments?   leafref
    ]]>
  </sourcecode>


  </section>

  <section title="Optical Impairment Topology YANG Model" anchor="sect-4">
  
  <t>
   [Editor's note: YANG code below always has to be updated before submitting a new revision!]
  </t>

  <sourcecode name="ietf-optical-impairment-topology.yang" type="yang" markers="true">
    <![CDATA[
module ietf-optical-impairment-topology {
  yang-version 1.1;

  namespace "urn:ietf:params:xml"
          + ":ns:yang:ietf-optical-impairment-topology";

  prefix "optical-imp-topo";

  import ietf-network {
    prefix "nw";
  }

  import ietf-network-topology {
    prefix "nt";
  }

  import ietf-te-topology {
    prefix "tet";
  }

  import ietf-te-types {
    prefix "te-types";
  }

  import ietf-layer0-types {
    prefix "l0-types";
  }

  organization
    "IETF CCAMP Working Group";

  contact
    "WG Web: <https://datatracker.ietf.org/wg/ccamp/>
     WG List: <mailto:ccamp@ietf.org>

     Editor:   Young Lee <younglee.tx@gmail.com>
     Editor:   Haomian Zheng <zhenghaomian@huawei.com>
     Editor:   Nicola Sambo <nicosambo@gmail.com>
     Editor:   Victor Lopez <victor.lopezalvarez@telefonica.com>
     Editor:   Gabriele Galimberti <ggalimbe@cisco.com>
     Editor:   Giovanni Martinelli <giomarti@cisco.com>
     Editor:   Jean-Luc Auge <jeanluc.auge@orange.com>
     Editor:   Le Rouzic Esther <esther.lerouzic@orange.com>
     Editor:   Julien Meuric <julien.meuric@orange.com>
     Editor:   Italo Busi <Italo.Busi@huawei.com>
     Editor:   Dieter Beller <dieter.beller@nokia.com>
     Editor:   Sergio Belotti <Sergio.belotti@nokia.com>
     Editor:   Griseri Enrico <enrico.griseri@nokia.com>
     Editor:   Gert Grammel <ggrammel@juniper.net>";

  description
    "This module contains a collection of YANG definitions for
     impairment-aware optical networks.

     Within this module, if the value of a mandatory attribute is
     unknown, it MUST be reported using the empty type.
     If an optional attribute is applicable but its value is unknown,
     it MUST be reported using the empty type.
     If an optional attribute is not applicable to an entity, it MUST
     be omitted (not be present in the datastore).

     The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL
     NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'NOT RECOMMENDED',
     'MAY', and 'OPTIONAL' in this document are to be interpreted as
     described in BCP 14 (RFC 2119) (RFC 8174) when, and only when,
     they appear in all capitals, as shown here.

     Copyright (c) 2022 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Revised BSD
     License set forth in Section 4.c of the IETF Trust's Legal
     Provisions Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX; see
     the RFC itself for full legal notices.";

// RFC Ed.: replace XXXX with actual RFC number and remove
// this note
// replace the revision date with the module publication date
// the format is (year-month-day)
  revision 2022-10-21 {
    description
      "Initial Version";
    reference
      "RFC XXXX: A Yang Data Model for Impairment-aware
       Optical Networks";
  }

  /*
   * Identities
   */

  identity otsi-protection {
    base te-types:lsp-protection-type;
    description
      "Individual OTSi(G) protection LSP protection type.";
    reference
      "ITU-T G.873.1 v5.2 (02/2022): Optical transport network: 
      Linear protection";
  }

  // groupings

  grouping sliceable-transponder-attributes {
    description
      "Configuration of a sliceable transponder.";
    list sliceable-transponder-list {
      key "carrier-id";
      config false;
      description "List of carriers";
      leaf carrier-id {
        type uint32;
        config false;
        description "Identifier of the carrier";
      }
    }
  }

  /*
   * Groupings
   */

  grouping amplifier-params {
    description "describes parameters for an amplifier";
    container amplifier {
      description
        "amplifier type, operatonal parameters are described.";
      leaf type-variety {
        type string;
        mandatory true ;
        description
          "String identifier of amplifier type referencing
          a specification in a separate equipment catalog";
      }
      container operational {
        description "amplifier operational parameters";
        list amplifier-element {
          description
            "The list of parallel amplifier elements within an
            amplifier used to amplify different frequency ranges.";
          leaf name {
            type string;
            description
              "The name of the amplifier element as specified in
              the vendor's specification associated with the
              type-variety.";
          }
          container frequency-range {
            description
              "The frequency range amplified by the amplifier
              element.";
            uses l0-types:frequency-range;
          }
          leaf actual-gain {
            type l0-types:power-in-db-or-null;
            mandatory true ;
            description "..";
          }
          leaf tilt-target {
            type l0-types:decimal-2-digits-or-null;
            mandatory true ;
            description
              "The tilt target defined between lower and upper
              frequency of the amplifier frequency range.";
          }
          leaf out-voa {
            type l0-types:power-in-db-or-null;
            units dB;
            mandatory true;
            description "..";
          }
          leaf in-voa {
            type l0-types:power-in-db-or-null;
            mandatory true;
            description "..";
          }
          leaf total-output-power {
            type l0-types:power-in-db-or-null;
            mandatory true;
            description
              "It represent total output power measured in the range
              specified by the frequency-range.
              
              Optical power is especially needed to re-compute/check
              consistency of span (fiber+ concentrated loss) loss
              value, with respect to loss/gain information on
              elements.";
          }
          uses power-param;
          leaf raman-direction {
            type enumeration {
              enum co-propagating {
                description
                  "Co-propagating indicates that optical pump light
                  is injected in the same direction to the optical
                  signal that is amplified (forward pump).";
              }
              enum counter-propagating {
                description
                  "Counter-propagating indicates that optical pump
                  light is injected in opposite direction to the
                  optical signal that is amplified (backward pump).";
              }
            }
            description
              "The direction of injection of the raman pump.";
          }
          list raman-pump {
            description
              "The list of pumps for the Raman amplifier.";
            leaf frequency {
              type l0-types:frequency-thz;
              description
                "The raman pump central frequency.";
            }
            leaf power {
              type l0-types:decimal-2-digits-or-null;
              units "Watts";
              description
                "The total pump power considering a depolarized pump
                at the raman pump central frequency.";
            }
          }
        }  // list amplifier-element
      }  // container operational
    }  // container amplifier
  }  // grouping amplifier-params

  grouping fiber-params {
    description 
      "String identifier of fiber type referencing a 
       specification in a separate equipment catalog";
    container fiber {
      description "fiber characteristics";
      leaf type-variety {
        type string ;
        mandatory true ;
        description "fiber type";
      }
      leaf length {
        type l0-types:decimal-2-digits-or-null;
        units km;
        mandatory true ;
        description "length of fiber";
      }
      leaf loss-coef {
        type l0-types:decimal-2-digits-or-null;
        units dB/km;
        mandatory true ;
        description "loss coefficient of the fiber";
      }
      leaf total-loss {
        type l0-types:power-in-db-or-null;
        mandatory true ;
        description
          "includes all losses: fiber loss and conn-in and 
           conn-out losses";
      }
      leaf pmd{
        type l0-types:decimal-2-digits-or-null;
        units sqrt(ps);
        description "pmd of the fiber";
      }
      leaf conn-in{
        type l0-types:power-in-db-or-null;
        description "connector-in";
      }
      leaf conn-out{
        type l0-types:power-in-db-or-null;
        description "connector-out";
      }
    }
  }

  grouping roadm-express-path {
    description
      "The optical impairments of a ROADM express path.";
    leaf roadm-pmd {
      type union {
        type decimal64 {
          fraction-digits 8;
          range "0..max";
        }
        type empty;
      }
      units "ps/(km)^0.5"; 
      description 
        "Polarization Mode Dispersion";
    }
    leaf roadm-cd {
      type union {
        type decimal64 {
          fraction-digits 5;
        }
        type empty;
      }
      units "ps/nm";
      description "Chromatic Dispersion";
    }            
    leaf roadm-pdl {
      type l0-types:power-in-db-or-null;
      description "Polarization dependent loss";        
    }      
    leaf roadm-inband-crosstalk {
      type l0-types:power-in-db-or-null;
      description
        "In-band crosstalk, or coherent crosstalk, can occur in
          components that can have multiple same wavelength inputs
          with the inputs either routed to different output ports,
          or all but 1 blocked";
    }
    leaf roadm-maxloss {
      type l0-types:power-in-db-or-null;
      description
        "This is the maximum expected add path loss from the 
          ROADM ingress to the ROADM egress 
          assuming no additional add path loss is added";
    }
  }
                                                               
  grouping roadm-add-path {
    description "The optical impairments of a ROADM add path.";   
    leaf roadm-pmd {
      type union {
        type decimal64 {
          fraction-digits 8;
          range "0..max";
        }
        type empty;
      }
      units "ps"; 
      description 
        "Polarization Mode Dispersion";
    }
    leaf roadm-cd {
      type union {
        type decimal64 {
          fraction-digits 5;
        }
        type empty;
      }
      units "ps/nm"; 
      description "Cromatic Dispersion";
    }            
    leaf roadm-pdl {
      type l0-types:power-in-db-or-null;
      description "Polarization dependent loss";      
    }      
    leaf roadm-inband-crosstalk {
      type l0-types:power-in-db-or-null;
      description
        "In-band crosstalk, or coherent crosstalk, 
          can occur in components that can have multiple same
          wavelength inputs,with the inputs either 
          routed to different output ports,
          or all but 1 blocked.
          In the case of add path it is the total 
          of the add block
          + egress WSS crosstalk contributions.";
    }
    leaf roadm-maxloss {
      type l0-types:power-in-db-or-null;
      description 
        "This is the maximum expected add path loss from 
          the add/drop port input to the ROADM egress, 
          assuming no additional add path loss is added.  
          This is used to establish the minimum required
          transponder output power required 
          to hit the ROADM egress target power 
          levels and preventing 
          to hit the WSS attenuation limits.
          If the add path contains an internal amplifier 
          this loss value should be based 
          on worst case expected amplifier gain due to
          ripple or gain uncertainty";        
    }
    leaf roadm-pmax {
      type l0-types:power-in-dbm-or-null;
      description 
        "This is the maximum (per carrier) power level 
          permitted at the add block input ports,
          that can be handled by the ROADM node. 
          This may reflect either add amplifier power 
          contraints or WSS adjustment limits.
          Higher power transponders would need to have 
          their launch power reduced 
          to this value or lower";
    }
    leaf roadm-osnr {
      type l0-types:snr-or-null;
      description 
        "Optical Signal-to-Noise Ratio (OSNR).
          If the add path contains the ability to adjust the 
          carrier power levels into an add path amplifier 
          (if present) to a target value,
          this reflects the OSNR contribution of the
          add amplifier assuming this target value is obtained.
          The worst case OSNR based on the input power and 
          NF calculation method, and this value, should be used
          (if both are defined).";
    }
    leaf roadm-noise-figure {
      type union {
        type decimal64 {
          fraction-digits 5;
        }
        type empty;
      }
      units "dB"; 
      description 
        "Noise Figure. If the add path contains an amplifier, 
          this is the noise figure of that amplifier inferred
          to the add port.
          This permits add path OSNR calculation based 
          on the input power levels to the add block
          without knowing the ROADM path losses to 
          the add amplifier.";
    }
  }

  grouping roadm-drop-path {
    description "roadm drop block path optical impairments";
    leaf roadm-pmd {
      type union {
        type decimal64 {
          fraction-digits 8;
          range "0..max";
        }
        type empty;
      }
      units "ps/(km)^0.5"; 
      description 
        "Polarization Mode Dispersion";
    }
    leaf roadm-cd {
      type union {
        type decimal64 {
          fraction-digits 5;
        }
        type empty;
      }
      units "ps/nm"; 
      description "Chromatic Dispersion";
    }            
    leaf roadm-pdl {
      type l0-types:power-in-db-or-null;
      description "Polarization dependent loss";        
    }      
    leaf roadm-inband-crosstalk {
      type l0-types:power-in-db-or-null;
      description
        "In-band crosstalk, or coherent crosstalk, can occur in
          components that can have multiple same wavelength 
          inputs,with the inputs either routed to different
          output ports,or all but 1 blocked.
          In the case of drop path it is the total 
          of the ingress
          to drop e.g. WSS and drop block crosstalk
          contributions.";
    }
    leaf roadm-maxloss {
      type l0-types:power-in-db-or-null;
      description 
        "The net loss from the ROADM input,to the output 
          of the drop block. 
          If ROADM ingress to drop path includes an amplifier,
          the amplifier gain reduces the net loss.  
          This is before any additional drop path attenuation
          that may be required 
          due to drop amplifier power contraints.
          The max value correspond to worst case expected loss,
          including amplifier gain ripple or uncertainty. 
          It is the maximum output power of the drop 
          amplifier.";        
    }
    leaf roadm-minloss {
      type l0-types:power-in-db-or-null;
      description 
        "The net loss from the ROADM input, to the 
          output of the drop block.
          If this ROADM ingress to drop path includes 
          an amplifier,the amplifier gain reduces the net loss.  
          This is before any additional drop path attenuation 
          that may be required due to drop amplifier power 
          contraints.
          The min value correspond to best case expected loss, 
          including amplifier gain ripple or uncertainty.";        
    }
    leaf roadm-typloss {
      type l0-types:power-in-db-or-null;
      description 
        "The net loss from the ROADM input, 
          to the output of the drop block.
          If this ROADM ingress to drop path 
          includes an amplifier, 
          the amplifier gain reduces the net loss.  
          This is before any additional drop path 
          attenuation 
          that may be required due to drop amplifier
          power contraints.
          The typ value correspond to typical case 
          expected loss.";        
    }
    leaf roadm-pmin {
      type l0-types:power-in-dbm-or-null;
      description 
        "If the drop path has additional loss
          that is added, for example,
          to hit target power levels into a 
          drop path amplifier, or simply, to reduce the
          power of a strong carrier
          (due to ripple,for example), 
          then the use of the ROADM input power levels and 
          the above drop losses is not appropriate.
          This parameter corresponds to the min per
          carrier power levels 
          expected at the output of the drop block.
          A detail example of the comparison using
          these parameters is 
          detailed in section xxx of the document yyy."; 
    }
    leaf roadm-pmax {
      type l0-types:power-in-dbm-or-null;
      description 
        "If the drop path has additional loss that is added, 
          for example, to hit target power levels into a 
          drop path amplifier,or simply,to reduce the power 
          of a strong carrier(due to ripple,for example), 
          then the use of the ROADM input power levels and the 
          above drop losses is not appropriate.
          This parameter corresponds to the best case per 
          carrier power levels expected at the output of the 
          drop block.
          A detail example of the comparison using 
          these parameters 
          is detailed in section xxx of the document yyy";        
    }
    leaf roadm-ptyp {
      type l0-types:power-in-dbm-or-null;
      description 
        "If the drop path has additional loss that is added,
          for example, to hit target power levels into a 
          drop path amplifier,or simply,to reduce the 
          power of a strong carrier(due to ripple,for example), 
          then the use of the ROADM input power levels and 
          the above drop losses is not appropriate.
          This parameter corresponds to the typical case
          per carrier power levels expected 
          at the output of the drop block.";        
    }
    leaf roadm-osnr {
      type l0-types:snr-or-null; 
      description 
        "Optical Signal-to-Noise Ratio (OSNR).
          Expected OSNR contribution of the drop path
          amplifier(if present) 
          for the case of additional drop path loss
          (before this amplifier) 
          in order to hit a target power level (per carrier).
          If both, the OSNR based on the ROADM 
          input power level
          (Pcarrier = 
          Pref+10Log(carrier-baudrate/ref-baud) + delta-power)
          and the input inferred NF(NF.drop), 
          and this OSNR value, are defined, 
          the minimum value between these two should be used";
    }
    leaf roadm-noise-figure {
      type union {
        type decimal64 {
          fraction-digits 5;
        }
        type empty;
      }
      units "dB"; 
      description 
        "Drop path Noise Figure. 
          If the drop path contains an amplifier,
          this is the noise figure
          of that amplifier, inferred to the 
          ROADM ingress port.
          This permits to determine 
          amplifier OSNR contribution 
          without having to specify the 
          ROADM node's losses to that amplifier.
          This applies for the case of no 
          additional drop path loss, 
          before the amplifier, in order to reduce the power
          of the carriers to a target value";
    }
  }

  grouping concentratedloss-params{
    description "concentrated loss";
    container concentratedloss{
      description "concentrated loss";
      leaf loss {
        type l0-types:power-in-db-or-null;
        mandatory true;
        description "..";
      }
    }
  }

  grouping power-param{
    description
      "optical power or PSD after the ROADM or after the out-voa";
    choice power-param {
      description
        "select the mode: channel power or power spectral density";
      case channel-power {
        when "/nw:networks/nw:network/nt:link/tet:te
            /tet:te-link-attributes/OMS-attributes
            /equalization-mode='carrier-power'";
        leaf nominal-carrier-power{
          type l0-types:power-in-dbm-or-null;
          description
            " Reference channel power. Same grouping is used for the
            OMS power after the ROADM (input of the OMS) or after the
            out-voa of each amplifier. ";
        }
      }
      case power-spectral-density{
        when "/nw:networks/nw:network/nt:link/tet:te
            /tet:te-link-attributes/OMS-attributes
            /equalization-mode='power-spectral-density'";
        leaf nominal-power-spectral-density{
          type union {
            type decimal64 {
                fraction-digits 16;
            }
            type empty;
          }
          units W/Hz ;
          description
            " Reference power spectral density after 
              the ROADM or after the out-voa.
              Typical value : 3.9 E-14, resolution 0.1nW/MHz";
        }
      }
    }
  }

  grouping oms-general-optical-params {
    description "OMS link optical parameters";
    leaf generalized-snr {
      type l0-types:snr;
      description "generalized snr";
    }
    leaf equalization-mode{
      type identityref {
        base l0-types:type-power-mode;
      }
      mandatory true;
      description "equalization mode";
    }
    uses power-param;
  }

  grouping otsi-group {
    description "OTSiG definition , representing client
     digital information stream supported by 1 or more OTSi";

    list otsi {
      key "otsi-carrier-id";
      config false;
      description
        "list of OTSi contained in 1 OTSiG.
        The list could also be of only 1 element";
      leaf otsi-carrier-id {
        type uint16;
        description "OTSi carrier-id";
      }
      leaf otsi-carrier-frequency {
        type union {
          type l0-types:frequency-thz;
          type empty;
        }
        description
          "OTSi carrier frequency, equivalent to the
          actual configured transmitter frequency";
      }
      leaf-list nmc-path-id {
        type uint16;
        description
          "The list of the possible Network Media Channel (NMC) paths
          associated with the OTSi which have different optical
          impairments.

          This list is meaningful in case the OTSi can be associated
          with multiple NMC paths
          (e.g., when OPS protection is configured).
          
          The list can be empty when the OTSi has only one
          NMC path.";
      }
    } // OTSi list
  } // OTSiG grouping

  grouping media-channel-groups {
    description "media channel groups";
    list media-channel-group {
    key "i";
      description
        "list of media channel groups";
      leaf i {
        type int16;
          description "index of media channel group member";
      }

      list media-channels {
        key "flexi-n";
        description
          "list of media channels represented as (n,m)";
 
 // this grouping add both n.m values
        uses l0-types:flexi-grid-frequency-slot; 

        leaf otsi-group-ref {
          type leafref {
            path "/nw:networks/nw:network/otsi-group/otsi-group-id";
          }
          description
            "Reference to the otsi-group list to get otsi-group
            identifier of the
            OTSiG carried by this media channel 
            that reports the transient stat";
        }
        list otsi-ref {
          description
            "The list of references to the OTSis and their NMC paths
            within the OTSiG carried by this media channel.";
          leaf otsi-carrier-ref {
            type leafref {
              path "/nw:networks/nw:network/"  
                + "otsi-group[otsi-group-id=current()"
                + "/../../otsi-group-ref]/"
                + "otsi/otsi-carrier-id" ;
            }
            description
              "Reference to the OTSi within the OTSiG carried
              by this media channel.";
          }
          leaf-list nmc-path-ref {
            type leafref {
              path "/nw:networks/nw:network/"  
                + "otsi-group[otsi-group-id=current()"
                + "/../../otsi-group-ref]/"
                + "otsi[otsi-carrier-id=current()"
                + "/../otsi-carrier-ref]/nmc-path-id" ;
            }
            description
              "References to the NMC paths of this OTSi which are
              routed through this media channel.";
          }
        }
        leaf delta-power {
          type l0-types:power-in-dbm-or-null;
          description
            " Deviation from the reference carrier power defined for
            the OMS.";
        }
      } // media channels list
    } // media-channel-groups list
  } // media media-channel-groups grouping

  grouping oms-element {
    description "OMS description";
    list OMS-elements {
      key "elt-index";
      description
        "defines the spans and the amplifier blocks of 
        the amplified lines";
      leaf elt-index {
        type uint16;
        description
          "ordered list of Index of OMS element 
          (whether it's a Fiber, an EDFA or a
          Concentratedloss)";
      }
      leaf oms-element-uid {
        type union {
          type string;
          type empty;
        }
        description
          "unique id of the element if it exists";
      }
      container reverse-element-ref {
        description
          "It contains references to the elements which are
          associated with this element in the reverse
          direction.";
        leaf link-ref {
          type leafref {
            path "../../../../../../../nt:link/nt:link-id";
          }
          description
            "The reference to the OMS link which the OMS elements
            belongs to.";
        }
        leaf-list oms-element-ref {
          type leafref {
            path "../../../../../../../nt:link[nt:link-id="
                + "current()/../link-ref]/tet:te/"
                + "tet:te-link-attributes/OMS-attributes/"
                + "OMS-elements/elt-index";
          }
          description
            "The references to the OMS elements.";
        }
      }
      choice element {
        mandatory true;
        description "OMS element type";
        case amplifier {
          uses tet:geolocation-container;
          uses amplifier-params;
        }
        case fiber {
          uses fiber-params;
        }
        case concentratedloss {
          uses concentratedloss-params ;
        }
      }
    }
  }

  grouping otsi-ref {
    description
      "References to an OTSi.
      This grouping is intended to be reused within the
      transceiver's list only.";
    leaf otsi-group-ref {
      type leafref {
        path "../../../../../otsi-group/otsi-group-id";
      }
      description
        "The OTSi generated by the transceiver's transmitter.";
    }
    leaf otsi-ref {
      type leafref {
        path "../../../../../otsi-group[otsi-group-id=" +
             "current()/../otsi-group-ref]/otsi/otsi-carrier-id";
      }
      description
        "The OTSi generated by the transceiver's transmitter.";
    }
  }
/* Data nodes */

  augment "/nw:networks/nw:network/nw:network-types"
        + "/tet:te-topology" {
    description "optical-impairment topology augmented";
    container optical-impairment-topology {
      presence
        "Indicates an impairment-aware topology of optical networks";
      description
        "Container to identify impairment-aware topology type";
   }
  }

  augment "/nw:networks/nw:network" {
    when "nw:network-types/tet:te-topology" +
         "/optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment 
        topology.";
    }
    description
      "Network augmentation for optical impairments data.";
    list otsi-group {
      key "otsi-group-id";
      config false;
      description
        "the list of possible OTSiG representing client digital
        stream";
      leaf otsi-group-id {
        type string;
        description
          "A network-wide unique identifier of otsi-group element.
          It could be structured e.g., as an URI or as an UUID.";
      }
      uses otsi-group;
    } // list of OTSiG
  }

  augment "/nw:networks/nw:network/nw:node" {
    when "../nw:network-types/tet:te-topology" +
         "/optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment.";
    }
    description
      "Node augmentation for optical impairments data.";
    list transponder {
      key "transponder-id";
      config false;
      description "list of transponder";
      leaf transponder-id {
        type uint32;
        description "transponder identifier";
      }
      leaf termination-type-capabilities {
        type enumeration {
          enum tunnel-only {
            description
              "The transponder can only be used in an Optical
              Tunnel termination configuration.";
          }
          enum 3r-only {
            description
              "The transponder can only be used in a 3R
              configuration.";
          }
          enum 3r-or-tunnel {
            description
              "The transponder can be configure to be used either
              in an Optical Tunnel termination configuration or in
              a 3R configuration.";
          }
        }
        description
          "Describes whether the transponder can be used in an
          Optical Tunnel termination configuration or in a 3R
          configuration (or both).";
      }
      leaf supported-3r-mode {
        when '(../termination-type-capabilities = "3r-only") or
              (../termination-type-capabilities = "3r-or-tunnel")'
              {
          description
            "Applies only when the transponder supports 3R
            configuration.";
        }
        type enumeration {
          enum unidir {
            description
              "Unidirectional 3R configuration.";
          }
          enum bidir {
            description
              "Bidirectional 3R configuration.";
          }
        }
        description
          "Describes the supported 3R configuration type."; 
      }
      list transceiver {
        key "transceiver-id";
        config false;
        description "list of transceiver related to a transponder";
        leaf transceiver-id {
          type uint32;
          description "transceiver identifier";
        }
        uses l0-types:transceiver-capabilities;
        leaf configured-mode {
          type leafref {
            path "../supported-modes/supported-mode/mode-id";
          }
          description
            "Reference to the configured mode for transceiver
            compatibility approach.";
        }
        uses l0-types:common-transceiver-configured-param;
        container outgoing-otsi {
          description
            "The OTSi generated by the transceiver's transmitter.";
          uses otsi-ref;
        }
        container incoming-otsi {
          description
            "The OTSi received by the transceiver's received.";
          uses otsi-ref;
        }
        leaf configured-termination-type {
          type enumeration {
            enum tunnel-termination {
              description
                "The transceiver is currently used in an Optical
                Tunnel termination configuration.";
            }
            enum 3r-regeneration {
              description
                "The transceiver is currently used in a 3R
                configuration.";
            }
          }
          description
            "Describes whether the current configuration of the
            transceiver is used in an Optical Tunnel termination
            configuration or in a 3R configuration.
            
            If empty, it means that the transcevier is not used.";
        }
      } // end of list of transceiver 
    } // end list of transponder
    list regen-group {
      key "group-id";
      config false;
      description
        "List of 3R groups.
        Any 3R group represent a group of transponder in which an a
        an electrical connectivity is either in place or could be
        dynamically provided, to associated transponders used for 3R
        regeneration.";
      leaf group-id {
        type uint32;
        description
          "Group identifier used an index to access elements in the
          list of 3R groups.";
      }
      leaf regen-metric {
        type uint32;
        description
          "The cost permits choice among different group of
          transponders during path computation";
      }
      leaf-list transponder-ref {
        type leafref {
          path "../../transponder/transponder-id";
        }
        description
          "The list of transponder belonging to this 3R group.";
      }
    } // end 3R-group
  }

  augment "/nw:networks/nw:network/nt:link/tet:te"
        + "/tet:te-link-attributes"   {
    when "../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment 
        topology.";
    }
    description "Optical Link augmentation for impairment data.";
    container OMS-attributes {
      config false;
      description "OMS attributes";
      uses oms-general-optical-params;
      uses media-channel-groups;
      uses oms-element;
    }
  }

  augment "/nw:networks/nw:network/nw:node/tet:te"
        + "/tet:tunnel-termination-point" {
    when "../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Impairment with
         non-sliceable transponder model";
    }
    description
      "Tunnel termination point augmentation for non-sliceable
       transponder model.";

    list ttp-transceiver {
      key "transponder-ref transceiver-ref";
      config false;
      description
        "The list of the transceivers used by the TTP.";
      leaf transponder-ref {
        type leafref {
          path "../../../../transponder/transponder-id";
        }
        description
          "The reference to the transponder hosting the transceiver
          of the TTP.";
      }
      leaf transceiver-ref {
        type leafref {
          path "../../../../transponder[transponder-id=current()" +
               "/../transponder-ref]/transceiver/transceiver-id";
        }
        description
          "The reference to the transceiver of the TTP.";
      }
    } // list of transceivers
  } // end of augment

  augment "/nw:networks/nw:network/nw:node/tet:te"
        + "/tet:tunnel-termination-point" {
    when "../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for optical impairment
       with sliceable transponder model";
    }
    description
      "Tunnel termination point augmentation for sliceable
      transponder model.";
    uses sliceable-transponder-attributes;
  }

  // Should this leaf be moved to te-topology?
  augment "/nw:networks/nw:network/nw:node/nt:termination-point" {
    when "../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment 
        topology";
    }
    description
      "Augment LTP";
    leaf protection-type {
      type identityref {
        base te-types:lsp-protection-type;
      }
      description
        "The protection type that this LTP is capable of.";
    }
  }

  augment "/nw:networks/nw:network/nw:node/tet:te"
        + "/tet:te-node-attributes" {
    when "../../../nw:network-types/tet:te-topology"
       + "/optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment 
        topology";
    }
    description
      "node attributes augmentantion for optical-impairment ROADM
       node";

    list roadm-path-impairments {
      key "roadm-path-impairments-id";
      config false;
      description
        "The set of optical impairments related to a ROADM path.";

      leaf roadm-path-impairments-id {
        type uint32; 
        description "index of the ROADM path-impairment list";
      }
      choice impairment-type {
        description "type path impairment";
        case roadm-express-path {
          list roadm-express-path {
            description
              "The list of optical impairments on a ROADM express
              path for different frequency ranges.
              
              Two elements in the list must not have the same range
              or overlapping ranges.";
            container frequency-range {
              description
                "The frequency range for which these optical
                impairments apply.";
              uses l0-types:frequency-range;
            }
            uses roadm-express-path;
          } 
        }
        case roadm-add-path {
          list roadm-add-path {
            description
              "The list of optical impairments on a ROADM add
              path for different frequency ranges.
              
              Two elements in the list must not have the same range
              or overlapping ranges.";
            container frequency-range {
              description
                "The frequency range for which these optical
                impairments apply.";
              uses l0-types:frequency-range;
            }
            uses roadm-add-path; 
          }
        }          
        case roadm-drop-path {
          list roadm-drop-path {
            description
              "The list of optical impairments on a ROADM add
              path for different frequency ranges.
              
              Two elements in the list must not have the same range
              or overlapping ranges.";
            container frequency-range {
              description
                "The frequency range for which these optical
                impairments apply.";
              uses l0-types:frequency-range;
            }
            uses roadm-drop-path; 
          }
        }
      }
    } // list path impairments 
  } // augmentation for optical-impairment ROADM 

  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:information-source-entry/tet:connectivity-matrices"{
    when "../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment 
        topology ";
    }  
    description
      "Augment default TE node connectivity matrix information 
      source.";

    leaf roadm-path-impairments {
      type leafref {
        path "../../../tet:te-node-attributes/"
        + "roadm-path-impairments/roadm-path-impairments-id";
      }
      description "pointer to the list set of ROADM optical 
      impairments";
    }
  } // augmentation connectivity-matrices information-source
  
  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:information-source-entry/tet:connectivity-matrices/"
        + "tet:connectivity-matrix" {
    when "../../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment
         topology ";
    }
    description
      "Augment TE node connectivity matrix entry information 
      source.";
    leaf roadm-path-impairments {
      type leafref {
        path "../../../../tet:te-node-attributes/"
        + "roadm-path-impairments/roadm-path-impairments-id";
      }
      description "pointer to the list set of ROADM optical 
      impairments";
    } 
  } // augmentation connectivity-matrix information-source

  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:te-node-attributes/tet:connectivity-matrices" {
    when "../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for Optical Impairment 
        topology ";
    }  
    description
      "Augment default TE node connectivity matrix.";
    leaf roadm-path-impairments {
      type leafref {
        path "../../roadm-path-impairments/"
        + "roadm-path-impairments-id";
      }
      config false; /*the identifier in the list */
       /*"roadm-path-impairments" of ROADM optical impairment*/
                    /*is read-only as the rest of attributes*/ 
      description "pointer to the list set of ROADM optical 
      impairments";
    } 
  } // augmentation connectivity-matrices
  
  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:te-node-attributes/"
        + "tet:connectivity-matrices/tet:connectivity-matrix" {
    when "../../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for 
        Optical Impairment topology ";
    }
    description
      "Augment TE node connectivity matrix entry.";
    leaf roadm-path-impairments {
      type leafref {
        path "../../../roadm-path-impairments/"
        + "roadm-path-impairments-id";
      }
      config false;
      description "pointer to the list set of ROADM optical
       impairments";
    }
  } // augmentation connectivity-matrix

  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:te-node-attributes/tet:connectivity-matrices/"
        + "tet:connectivity-matrix/tet:from" {
    when "../../../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for 
        Optical Impairment topology ";
    }
    description
      "Augment the attributes for the 'from' LTP for the TE node 
      connectivity matrix entry.";
    list additional-ltp {
      when "derived-from-or-self(../../../../../../"
         + "nt:termination-point"
         + "[nt:tp-id=current()/../../tet:to/tet:tp-ref]/"
         + "optical-imp-topo:protection-type,"
         + "'optical-imp-topo:otsi-protection')" {
        description
          "This list applies only when the 'to' LTP for this 
          connectivity matrix entry supports individual OTSi(G) 
          protection.";
      }
      key "ltp-ref";
      config false;
      description
        "The restricted list of the potential secondary LTPs that 
        can be selected when the 'from' LTP of this connectivity 
        matrix entry is selected as a working LTP.
        
        If this list is empty, all the other LTPs that can reach 
        the 'to' LTP of this connectivity matrix entry can be 
        selected as secondary LTPs.";
      leaf ltp-ref {
        type leafref {
          path "../../../../../../../nt:termination-point/nt:tp-id";
        }
        description
          "The reference to the potential secondary LTP that can be 
          selected when the 'from' LTP of this connectivity matrix 
          entry is selected as a working LTP";
      }
      leaf roadm-path-impairments {
        type leafref {
          path "../../../../../../../tet:te/tet:te-node-attributes/"
             + "roadm-path-impairments/roadm-path-impairments-id";
        }
        config false;
        description
          "Pointer to ROADM optical impairments of the ROADM path 
          between this secondary 'from' LTP and the 'to' LTP of 
          this connectivity matrix entry.";
      }    
    }
  } // augmentation connectivity-matrix from

  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:te-node-attributes/tet:connectivity-matrices/"
        + "tet:connectivity-matrix/tet:to" {
    when "../../../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for 
        Optical Impairment topology ";
    }
    description
      "Augment the attributes for the 'to' LTP for the TE node 
      connectivity matrix entry.";
    list additional-ltp {
      when "derived-from-or-self(../../../../../../"
         + "nt:termination-point"
         + "[nt:tp-id=current()/../../tet:from/tet:tp-ref]/"
         + "optical-imp-topo:protection-type,"
         + "'optical-imp-topo:otsi-protection')" {
        description
          "This list applies only when the 'from' LTP for this 
          connectivity matrix entry supports individual OTSi(G) 
          protection.";
      }
      key "ltp-ref";
      config false;
      description
        "The restricted list of the potential secondary LTPs that 
        can be selected when the 'to' LTP of this connectivity 
        matrix entry is selected as a working LTP.
        
        If this list is empty, all the other LTPs that can be 
        reached from the 'from' LTP of this connectivity matrix 
        entry can be selected as secondary LTPs.";
      leaf ltp-ref {
        type leafref {
          path "../../../../../../../nt:termination-point/nt:tp-id";
        }
        description
          "The reference to the potential secondary LTP that can be 
          selected when the 'to' LTP of this connectivity matrix 
          entry is selected as a working LTP";
      }
      leaf roadm-path-impairments {
        type leafref {
          path "../../../../../../../tet:te/tet:te-node-attributes/"
             + "roadm-path-impairments/roadm-path-impairments-id";
        }
        config false;
        description
          "Pointer to ROADM optical impairments of the ROADM path 
          between the 'from' LTP of this connectivity matrix entry 
          and this secondary LTP.";
      }    
    }
  } // augmentation connectivity-matrix to

  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:tunnel-termination-point/"
        + "tet:local-link-connectivities" {
    when "../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
      "This augment is only valid for Optical Impairment topology ";
    }
    description
      "Augment default TTP LLC.";
    leaf add-path-impairments {
      type leafref {
        path "../../../tet:te-node-attributes/"
        + "roadm-path-impairments/roadm-path-impairments-id" ;
      }
      config false;
      description "pointer to the list set of ROADM optical
       impairments";
    }
    leaf drop-path-impairments {
      type leafref {
        path "../../../tet:te-node-attributes/"
        + "roadm-path-impairments/roadm-path-impairments-id" ;
      }
      config false;
      description "pointer to the list set of ROADM 
      optical impairments";
    }
  } // augmentation local-link-connectivities

  augment "/nw:networks/nw:network/nw:node/tet:te/"
        + "tet:tunnel-termination-point/"
        + "tet:local-link-connectivities/"
        + "tet:local-link-connectivity" {
    when "../../../../../nw:network-types/tet:te-topology/"
       + "optical-imp-topo:optical-impairment-topology" {
      description
        "This augment is only valid for
         Optical Impairment topology ";
    }
    description
      "Augment TTP LLC entry.";
    leaf add-path-impairments {
      type leafref {
        path "../../../../tet:te-node-attributes/"
        + "roadm-path-impairments/roadm-path-impairments-id" ;
      }
      config false;
      description "pointer to the list set of ROADM optical
       impairments";
    }
    leaf drop-path-impairments {
      type leafref {
        path "../../../../tet:te-node-attributes/"
        + "roadm-path-impairments/roadm-path-impairments-id" ;
      }
      config false;
      description "pointer to the list set of ROADM optical 
      impairments";
    }
    list llc-transceiver {
      key "ttp-transponder-ref ttp-transceiver-ref";
      config false;
      description
        "The list of transceivers having a LLC different from the
        default LLC.";
      leaf ttp-transponder-ref {
        type leafref {
          path "../../../../ttp-transceiver/transponder-ref";
        }
        description
          "The reference to the transponder hosting the transceiver
          of this LLCL entry.";
      }
      leaf ttp-transceiver-ref {
        type leafref {
          path "../../../../ttp-transceiver/transceiver-ref";
        }
        description
          "The reference to the the transceiver of this LLCL entry.";
      }
      leaf is-allowed {
        type boolean;
        description
          "'true' - connectivity from this transceiver is allowed;
          'false' - connectivity from this transceiver is
          disallowed.";
      }
      leaf add-path-impairments {
        type leafref {
          path "../../../../../tet:te-node-attributes/"
          + "roadm-path-impairments/roadm-path-impairments-id" ;
        }
        config false;
        description "pointer to the list set of ROADM optical
        impairments";
      }
      leaf drop-path-impairments {
        type leafref {
          path "../../../../../tet:te-node-attributes/"
          + "roadm-path-impairments/roadm-path-impairments-id" ;
        }
        config false;
        description "pointer to the list set of ROADM 
        optical impairments";
      }
    }
    list additional-ltp {
      when "derived-from-or-self(../../../tet:protection-type,"
         + "'optical-imp-topo:otsi-protection')" {
        description
          "This list applies only to TTPs that support individual 
          OTSi(G) protection.";
      }
      key "ltp-ref";
      config false;
      description
        "The restricted list of the potential secondary LTPs that 
        can be selected when the LTP associated with this LLCP 
        entry is selected as a working LTP.
        
        If this list is empty, all the other LTPs that can be 
        reached by this TTP can be selected as secondary LTPs.";
      leaf ltp-ref {
        type leafref {
          path "../../../../../../nt:termination-point/nt:tp-id";
        }
        description
          "The reference to potential secondary LTP that can be 
          selected when the LTP associated with this LLCP entry is 
          selected as a working LTP";
      }
      leaf add-path-impairments {
        type leafref {
          path "../../../../../tet:te-node-attributes/"
          + "roadm-path-impairments/roadm-path-impairments-id" ;
        }
        config false;
        description "pointer to the list set of ROADM optical
        impairments";
      }
      leaf drop-path-impairments {
        type leafref {
          path "../../../../../tet:te-node-attributes/"
          + "roadm-path-impairments/roadm-path-impairments-id" ;
        }
        config false;
        description "pointer to the list set of ROADM 
        optical impairments";
      }
    }
  } // augmentation local-link-connectivity
}
    ]]>
  </sourcecode>
  
  </section>

  <section title="Security Considerations" anchor="sect-5">
  <t>
   The configuration, state, and action data defined in this document
   are designed to be accessed via a management protocol with a secure
   transport layer, such as NETCONF <xref target="RFC6241"/>.  The
   NETCONF access control model <xref target="RFC8341"/> provides the
   means to restrict access for particular NETCONF users to a
   preconfigured subset of all available NETCONF protocol operations
   and content.
  </t>

  <t>
   A number of configuration data nodes defined in this document are
   read-only; however, these data nodes may be considered sensitive or
   vulnerable in some network environments (TBD).
  </t>

  </section>

  <section title="IANA Considerations" anchor="sect-6">
  <t>
   This document registers the following namespace URIs in the IETF XML
   registry [RFC3688]:
  </t>

  <figure><artwork><![CDATA[
--------------------------------------------------------------------
URI: urn:ietf:params:xml:ns:yang:ietf-optical-impairment-topology
Registrant Contact: The IESG.
XML: N/A, the requested URI is an XML namespace.
--------------------------------------------------------------------
]]></artwork>
  </figure>
  <t>
   This document registers the following YANG modules in the YANG
   Module Names registry <xref target="RFC7950"/>:</t>

  <figure><artwork><![CDATA[
--------------------------------------------------------------------
name:      ietf-optical-impairment-topology
namespace: urn:ietf:params:xml:ns:yang:ietf-optical-impairment-
topology
prefix:    optical-imp-topo
reference: RFC XXXX (TDB)
--------------------------------------------------------------------
]]></artwork>
  </figure>
  </section>

  <section title="Acknowledgments" anchor="sect-7">
  <t>
   We thank Daniele Ceccarelli and Oscar G. De Dios for useful
   discussions and motivation for this work.
  </t>

  </section>

  </middle>

  <back>
  
  <references title="Normative References">

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.2119.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.7950.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8040.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8341.xml"/>
  
  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8776.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8795.xml"/>

  
  </references>
  <references title="Informative References">
  
  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.6241.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.6566.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.7446.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.7579.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.7581.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.7698.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8340.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8342.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8345.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.8453.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.9093.xml"/>

  <xi:include href="https://www.rfc-editor.org/refs/bibxml/reference.RFC.9094.xml"/>

  <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ccamp-rfc9093-bis.xml"/>

  <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ccamp-dwdm-if-param-yang.xml"/>

  <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-teas-te-topo-and-tunnel-modeling.xml"/>


  <reference anchor="G.672">
   <front>
   <title>Characteristics of multi-degree reconfigurable optical add/drop multiplexers</title>
   <author>
   </author>
   <date month="October" year="2020"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.672"/>
  </reference>

  <reference anchor="G.807">
   <front>
   <title>Generic functional architecture of the optical media network</title>
   <author>
   </author>
   <date month="February" year="2020"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.807"/>
  </reference>
  
  <reference anchor="G.807 Amd1">
   <front>
   <title>Generic functional architecture of the optical media network Amendment 1</title>
   <author>
   </author>
   <date month="January" year="2021"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.807 Amendment 1"/>
  </reference>
  
   <reference anchor="G.709">
   <front>
   <title>Interfaces for the Optical Transport Network (OTN)</title>
   <author>
   </author>
   <date month="June" year="2016"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.709"/>
  </reference>
  
  <reference anchor="G.694.1">
   <front>
   <title>Spectral grids for WDM applications: DWDM frequency grid</title>
   <author>
   </author>
   <date month="February" year="2012"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.694.1"/>
  </reference>
  
  <reference anchor="G.959.1">
   <front>
   <title>Optical transport network physical layer interfaces</title>
   <author>
   </author>
   <date month="February" year="2012"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.959.1"/>
  </reference>

  <reference anchor="G.872">
   <front>
   <title>Architecture of optical transport networks</title>
   <author>
   </author>
   <date month="December" year="2019"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.872"/>
  </reference>

  <reference anchor="G.698.2">
   <front>
   <title>Amplified multichannel dense wavelength division multiplexing
          applications with single channel optical interfaces
   </title>
   <author>
   </author>
   <date month="November" year="2018"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.698.2"/>
  </reference>

  <reference anchor="G.798.1">
   <front>
   <title>Types and characteristics of optical transport network equipment</title>
   <author>
   </author>
   <date month="January" year="2013"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.798.1"/>
  </reference>
  
  <reference anchor="G.873.1">
   <front>
   <title>Optical transport network: Linear protection</title>
   <author>
   </author>
   <date month="October" year="2017"/>
   </front>
   <seriesInfo name="ITU-T" value="Recommendation G.873.1"/>
  </reference>
  
  </references>
    
  <section anchor="JSON Examples" numbered="true">
  <name>JSON Code Examples for Optical Protection Uses Cases</name>
  
  <t>
   [Editor's note: JSON examples for optical protection use cases TBA!
  </t>
  
  <ol type="(%d)" group="JSON examples">
    <li>JSON example for use case in  <xref target="Protection UC (i)"/>:</li>
  </ol>
  
  <t>
  [Editor's note: The JSON example below needs to be updated and aligned
  with <xref target="Figure-11"/> and <xref target="Figure-12"/>.]
  </t>
  
  <sourcecode type="json" markers="false">
    <![CDATA[
{
  "roadm-path-impairments": [
    {
      "roadm-path-impairments-id": 1,
      "roadm-add-path":
      "Add path impairments from TTP 1 or TTP 2 to any LTPs."
    },
    {
      "roadm-path-impairments-id": 2,
      "roadm-add-path": "Add path impairments from TTP 3 or TTP 4
       to LTP 1 or LTP 3, through AD1."
    },
    {
      "roadm-path-impairments-id": 3,
      "roadm-add-path": "Add path impairments from TTP 3 or TTP 4
       to LTP 1 or LTP 2, through AD2."
    }
  ],
  "tunnel-termination-point": [
    {
      "tunnel-tp-id": 1,
      "protection-type": "ops-protection",
      "local-link-connectivities": {
        "is-allowed": true,
        "add-path-impairments": 1
      }
    },
    {
      "tunnel-tp-id": 2,
      "local-link-connectivities": {
        "is-allowed": true,
        "add-path-impairments": 1,
        "local-link-connectivity": [
          {
            "link-tp-ref": "LTP-1",
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-2",
                "link-tp-ref": "LTP-3"
              }
            ]
          },
          {
            "link-tp-ref": "LTP-2",
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "link-tp-ref": "LTP-3"
              }
            ]
          },
          {
            "link-tp-ref": "LTP-3",
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "link-tp-ref": "LTP-2"
              }
            ]
          }
        ]
      }
    },
    {
      "tunnel-tp-id": 3,
      "protection-type": "ops-protection",
      "local-link-connectivities": {
        "is-allowed": false,
        "local-link-connectivity": [
          {
            "link-tp-ref": "LTP-1",
            "is-allowed": true,
            "add-path-impairments": 2,
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "add-path-impairments": 3
              },
              {
                "link-tp-ref": "LTP-2",
                "add-path-impairments": 3
              }
            ]
          },
          {
            "link-tp-ref": "LTP-3",
            "is-allowed": true,
            "add-path-impairments": 2,
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "add-path-impairments": 3
              },
              {
                "link-tp-ref": "LTP-2",
                "add-path-impairments": 3
              }
            ]
          }
        ]
      }
    },
    {
      "tunnel-tp-id": 4,
      "protection-type": "ops-protection",
      "local-link-connectivities": {
        "is-allowed": false,
        "local-link-connectivity": [
          {
            "link-tp-ref": "LTP-1",
            "is-allowed": true,
            "add-path-impairments": 2,
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "add-path-impairments": 3
              },
              {
                "link-tp-ref": "LTP-2",
                "add-path-impairments": 3
              }
            ]
          },
          {
            "link-tp-ref": "LTP-2",
            "is-allowed": true,
            "add-path-impairments": 3,
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "add-path-impairments": 2
              },
              {
                "link-tp-ref": "LTP-3",
                "add-path-impairments": 2
              }
            ]
          },
          {
            "link-tp-ref": "LTP-3",
            "is-allowed": true,
            "add-path-impairments": 2,
            "additional-ltp": [
              {
                "link-tp-ref": "LTP-1",
                "add-path-impairments": 3
              },
              {
                "link-tp-ref": "LTP-2",
                "add-path-impairments": 3
              }
            ]
          }
        ]
      }
    }
  ]
}
    ]]>
  </sourcecode>

  
  <ol type="(%d)" group="JSON examples">
    <li>JSON example for use case in  <xref target="Protection UC (ii)"/>
    with connectivity constraints:</li>
  </ol>
  
  <t>
  [Editor's note: UC (ii) JSON example below needs to be updated and aligned with
  <xref target="Figure-13"/> and <xref target="Figure-14"/>.]
  </t>
  
  <sourcecode type="json" markers="false">
    <![CDATA[
{
  "roadm-path-impairments": [
    {
      "roadm-path-impairments-id": 1,
      "roadm-add-path":
      "Add path impairments from LTP 10 to LTP 1 or LTP 2 or LTP 3."
    },
    {
      "roadm-path-impairments-id": 2,
      "roadm-add-path":
      "Add path impairments from LTP 20 or LTP 30 to LTP 1 or LTP 3,
       through AD1."
    },
    {
      "roadm-path-impairments-id": 3,
      "roadm-add-path":
      "Add path impairments from LTP 20 or LTP 30 to LTP 1 or LTP 2,
      through AD2."
    }
  ],

  "connectivity-matrix"[
    { 
      "id": 1,
      "from": {
        "tp-ref" : 20
      },
      "to" :  {
        "tp-ref" : 1,       
        "additional-ltp": [
           {
              "link-tp-ref": 1,
              "roadm-path-impairments": 3
           },
           {
              "link-tp-ref": 2,
              "roadm-path-impairments": 3
           }
        ]
      },
      "is-allowed": true,
      "roadm-path-impairments": 2
    },
    {
      "id": 2,
      "from": {
        "tp-ref" : 20
      },
      "to" :  {
        "tp-ref" : 3,        
        "additional-ltp": [
           {
              "link-tp-ref": 1,
              "roadm-path-impairments": 3
           },
           {
              "link-tp-ref": 2,
              "roadm-path-impairments": 3
           }
        ]
      },
      "is-allowed": true,
      "roadm-path-impairments": 2
    },
    {
      "id": 3,
      "from": {
        "tp-ref" : 30
      },
      "to" :  {
        "tp-ref" : 1,        
        "additional-ltp": [
           {
              "link-tp-ref": 1,
              "roadm-path-impairments": 2
           },
           {
              "link-tp-ref": 2,
              "roadm-path-impairments": 2            

           }
        ]
      },
      "is-allowed": true,
      "roadm-path-impairments": 2
    },
    {
      "id": 4,
      "from": {
        "tp-ref" : 30
      },
      "to" :  {
        "tp-ref" : 2,        
        "additional-ltp": [
           {
            "link-tp-ref": 1,
            "roadm-path-impairments": 2
           },
           {
            "link-tp-ref": 3,
            "roadm-path-impairments": 2            

           }
        ]
      },      
      "is-allowed": true,
      "roadm-path-impairments": 3
    },
    {
      "id": 5,
      "from": {
        "tp-ref" : 30
      },
      "to" :  {
        "tp-ref" : 3,        
        "additional-ltp": [
           {
            "link-tp-ref": 1,
            "roadm-path-impairments": 3
           },
           {
            "link-tp-ref": 2,
            "roadm-path-impairments": 3            

           }
        ]
      },      
      "is-allowed": true,
      "roadm-path-impairments": 2
    },
    {
      "id": 6,
      "from": {
        "tp-ref" : 40
      },
      "to" :  {
        "tp-ref" : 1        
      },      
      "is-allowed": true,
      "roadm-path-impairments": 3
    },
    {
      "id": 7,
      "from": {
        "tp-ref" : 40
      },
      "to" :  {
        "tp-ref" : 2,        
      },      
      "is-allowed": true,
      "roadm-path-impairments": 3
    }    

  ]
}
    ]]>
  </sourcecode>

  
  <ol type="(%d)" group="JSON examples">
    <li>JSON example for use case in  <xref target="Protection UC (iii)"/></li>
  </ol>
  
  <t>
   [Editor's note: UC (iii) JSON example TBA!]
  </t>
  
  </section>
  
  <section anchor="Remote OT configuration" numbered="true">
  <name>Optical Transponders in a Remote Shelf (Remote OTs)</name>
  
  <t>
   <xref target="Figure-Appendix-B"/> describes an example where the
   optical transponders and the ROADM are located in a different
   WDM-TE-nodes.
  </t>
  
  <figure align="center" title="Optical Transponders in a Remote Shelf
  (Remote OTs)" anchor="Figure-Appendix-B">
    <artwork><![CDATA[

      WDM-TE-Node-1                    WDM-TE-Node-2
   +----------------+           +--------------------------+
   |     Remote OTs |           |         ROADM            |
   |   +------------+           |     +------------+       |
   |   |            |           | AD  |            |       |
   |   |       +----|           | LTP |            | Line  |
 --o-->|       | Tx o---------->o---->o            | LTP 1 |
   |   | OT 1  +----|           |     |            o-------o<--->
 <-o---|       | Rx o<----------o<----o            |       |
   |   |       +----|           | AD  |            |       |
   |   |            |           | LTP |            |       |
   |   +------------+           |     |            |       |
   |                |           |     |            | Line  |
   |   +------------+           |     |            | LTP 2 |
   |   |            |           | AD  |            o-------o<--->
   |   |       +----|           | LTPs|            |       |
 --o-->|       | Tx o---------->o---->o            |       |
   |   |       +----|           |     |            |       |
 <-o---|       | Rx o<----------o<----o            |       |
   |   | OT 2  +----|           |     |            | Line  |     
 --o-->|       | Tx o---------->o---->o            | LTP 3 |
   |   |       +----|           |     |            o-------o<--->
 <-o---|       | Rx o<----------o<----o            |       |
   |   |       +----|           |     |            |       |
   |   |            |           |     |            |       |
   |   +------------+           |     +------------+       |
   |                |           |                          |
   +----------------+           +--------------------------+
   
]]> </artwork>
  </figure>

  <t>
   As described in <xref target="sect-2.3" />, the external shelf can
   be modeled as WDM-TE-Node with termination capability only (not
   switching) and the add/drop link between a remote optical
   transceiver and a ROADM add/drop port can be modeled as a WDM
   TE-link with the same optical impairments as those defined for a
   WDM TE-link between WDM-TE-nodes (OMS MCG).
  </t>
  
  <t>
   If the two WDM-TE-Nodes are reported in different network topology
   instances, the plug-id attribute, defined in 
   <xref target="RFC8795"/>, can be used to discover the adjacency for
   add/drop TE-links.
  </t>
  
  <t>
   It is worth noting that there are no standard protocols for
   automatic discovery of the adjacency between an external transceiver
   and a ROADM add/drop port and therefore the information reported in
   the plug-id can be either statically configured or provided through
   vendor-specific discovery mechanisms.
  </t>
  
  <t>
   Each add/drop TE-link carries a single OTSi between the transceiver
   and ROADM add/drop port and one or more OTSis in the reverse
   direction (between the ROADM add/drop and the transceiver).
  </t>

  <t>
   Depending on control architecture (e.g., when the two WDM-TE-Nodes
   are reported in different network topology instances by different
   controllers), the controller reporting the WDM-TE-Node, abstracting
   the external OT shelf, may be not able to provide the information
   about the end-to-end MC configuration (i.e.,flexi-n and flexi-m)
   nor of all the received OTSis, within the end-to-end MC, besides the
   configured incoming OTSi, since the end-to-end MC configuration
   depends on how the ROADM network is configured and the remote OT
   shelf is not aware of that.
  </t>

  <t>
   In this case only the incoming-otsi and outgoing-otsi can be
   reported within anend-to-end MC with an unspecified frequency-slot
   (i.e., without reporting flexi-n and flexi-m configuration of the
   end-to-end MC).
  </t>
  
  <t>
   When an OTSiG has more than one OTSi, its OTSis are carried by
   different parallel add/drop TE-links. In order to represent the fact
   that these OTSis are co-routed, the add/drop TE-links are bundled
   together in a bundled add/drop TE-link. The finest granularity for
   the bundled add/drop TE-link is the set of all the add/drop TE-links
   terminating on the same OT.
  </t>

  <t>
   For example, in <xref target="Figure-Appendix-B"/>, it is possible
   to define two bundled add/drop TE-links, one for OT1 and one for OT2
   or just one add/drop TE-link both OTs.
  </t>

  <t>
   The model for a bundled add/drop TE-link and the relationship with
   its component TE-links is already defined in the bundled-links
   container of <xref target="RFC8795"/>.
  </t>

  <t>
   In the general case, the optical impairments and connectivity
   constraints are reported for each add/drop TE-link and therefore no
   optical impairments are reported in the bundled add/drop TE-link
   that is used just to model the co-routing aspects of the OTSis
   belonging to the same OTSiG.
  </t>

  <t>
   The per-transceiver Local Link Connectivity (LLC) is used in the
   WDM-TE-Node which abstracts the remote OT shelf (e.g., WDM-TE-Node-1
   in <xref target="Figure-Appendix-B"/>), to represent the association
   between each transceiver and each LTP terminating the add/drop
   TE-link which models the transceiver port.
  </t>

  <t>
   The connectivity matrix in the WDM-TE-Node which abstract the edge
   ROADM (e.g., WDM-TE-Node-2 in <xref target="Figure-Appendix-B"/>)
   references the LTPs terminating the add/drop TE-links which models
   the ROADM add/drop ports.
  </t>

  </section>
  
  <section anchor="Contributors" numbered="false">
  <name>Contributors</name>
    <t>Thanks to all of the contributors.</t>
 
    <contact fullname="Aihua Guo" initials="A" surname="Guo">
      <organization>Huawei Technologies</organization>
      <address>
        <email>aguo@futurewei.com</email>
      </address>
    </contact>

    <contact fullname="Jonas Martensson" initials="J" surname="Martensson">
      <organization>Smartoptics</organization>
      <address>
        <email>jonas.martensson@smartoptics.com</email>
      </address>
    </contact>

  </section>
 

  <section anchor="Additional Authors" numbered="false">
  <name>Additional Authors</name>
  
    <contact fullname="Young Lee" initials="Y" surname="Lee">
      <organization>Samsung Electronics</organization>
      <address>
        <email>younglee.tx@gmail.com</email>
      </address>
    </contact>
    
    <contact fullname="Haomian Zheng" initials="H" surname="Zheng">
      <organization>Huawei Technologies</organization>
      <address>
        <email>zhenghaomian@huawei.com</email>
      </address>
    </contact>
    
    <contact fullname="Nicola Sambo" initials="N" surname="Sambo">
      <organization>Scuola Superiore Sant'Anna</organization>
      <address>
        <email>nicosambo@gmail.com</email>
      </address>
    </contact>
    
     <contact fullname="Giovanni Martinelli" initials="G" surname="Martinelli">
      <organization>Cisco</organization>
      <address>
        <email>giomarti@cisco.com</email>
      </address>
    </contact>
    
    <contact fullname="Jean-Luc Auge" initials="JL" surname="Auge">
      <organization>Orange</organization>
      <address>
        <email>jeanluc.auge@orange.com</email>
      </address>
    </contact>
    
    <contact fullname="Julien Meuric" initials="J" surname="Meuric">
      <organization>Orange</organization>
      <address>
        <email>julien.meuric@orange.com</email>
      </address>
    </contact>
    
    <contact fullname="Victor Lopez" initials="V" surname="Lopez">
      <organization>Nokia</organization>
      <address>
        <email>Victor.Lopez@nokia.com</email>
      </address>
    </contact>
    
    <contact fullname="Enrico Griseri" initials="E" surname="Griseri">
      <organization>Nokia</organization>
      <address>
        <email>Enrico.Griseri@nokia.com</email>
      </address>
    </contact>
    
    <contact fullname="Gert Grammel" initials="G" surname="Grammel">
      <organization>Juniper</organization>
      <address>
        <email>ggrammel@juniper.net</email>
      </address>
    </contact>

  </section>

  </back>

  </rfc>
  
